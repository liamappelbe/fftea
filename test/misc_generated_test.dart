// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';

import 'package:fftea/fftea.dart';
import 'package:fftea/impl.dart';
import 'package:test/test.dart';

import 'test_util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        -4.02155038, 7.33540930, 9.47742918, 2.27829614, //
        6.44826000, -8.62246363, 8.40875251, 3.88647911, //
        6.86460420, -1.96043232, 6.39989606, -1.45172358, //
        -8.44980629, -5.44055916, -9.98468554, -3.75150842,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        -0.32172403, 0.87855529, 2.20065831, 0.90642509, //
        3.79211269, -6.63929699, 7.67002525, 3.84741182, //
        6.79560048, -1.78820406, 4.92791996, -0.85373409, //
        -3.36177387, -1.26329741, -1.19585670, -0.30012067,
      ],
    );
    final b = [
        -6.86938615, 7.11394895, 9.48664646, 0.14618581, //
        -0.72719665, 2.66995309, 8.73716281, 3.18502361, //
        4.33932328, 1.43543019, -0.54790346, 8.42379304, //
        -1.46669443, 9.72710814, 9.27933168, 9.89814511, //
        6.46342788, 5.08581524, 5.79998383, 9.49639715, //
        5.54922671, 4.93477799, 4.92632096, -1.30506263, //
        9.06435250, -0.07369815, -2.84937980, 1.54938105, //
        8.38591617, 8.10403695, 0.18209554, -7.45830667,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        -0.54955089, 0.56911592, 1.13620701, 0.01750854, //
        -0.16885500, 0.61996290, 3.47609929, 1.26716860, //
        2.55188266, 0.84415222, -0.42188566, 6.48632064, //
        -1.33784213, 8.87256046, 9.18605488, 9.79864793, //
        6.39845683, 5.03469210, 5.29044260, 8.66211793, //
        4.27290457, 3.79977905, 2.89708607, -0.76748527, //
        3.60627243, -0.02932097, -0.66162576, 0.35976616, //
        1.00437354, 0.97061313, 0.01456764, -0.59666453,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        -7.41245920, 6.13494875, -3.35015089, 5.70409908, //
        9.41751985, 3.65529874, -6.68842376, -7.82350748, //
        -6.81035318, -6.90711130, -1.71044718, 5.34507228, //
        8.48253307, 6.42266698, 3.77465552, 7.22956097, //
        -1.22354018, -6.88851777, 6.27105548, 8.22527641, //
        -0.47048900, 0.72661125, -1.93008925, -2.49605629, //
        -3.51260175, -7.67052492, 9.94566652, 5.39625555, //
        0.95897811, -9.99157928, 7.54403380, 9.21480155, //
        -7.64149433, -6.62541419, 3.08556452, -7.47334666, //
        -1.93315259, 5.83512861, -2.29748316, -2.79424281, //
        3.55005659, 8.09794588, 6.80686617, -6.06910588, //
        1.29685008, -9.10602844, -7.12077846, 4.96500036, //
        1.01270798, 9.90709814, 6.82572969, -4.32333934, //
        0.27540953, -0.34599482, 5.61278297, 6.40289100, //
        5.47143185, -9.64509012, 0.07351073, -7.97017011, //
        -1.65845309, 2.08746668, -8.95607574, -7.76256700, //
        -0.69063134, 3.98465959, -5.57183299, 5.16447978, //
        -2.40523704, -9.11583067, -0.27574313, -6.84617429, //
        3.11156947, -2.48106284, 5.89507629, 1.36395227, //
        -1.56189380, -5.38293549, 4.28289687, -0.81264220, //
        -2.06413726, 4.18148151, 9.65338452, 7.80173292, //
        -0.98238402, 3.85932188, -9.27241671, 3.13982141, //
        -2.77029937, 2.72046580, 1.03228571, -2.15662630, //
        1.89848073, 4.95643265, -0.52373331, -2.06211492, //
        -0.98668381, -4.26711516, -5.06452329, 2.01892186, //
        -3.68509863, -0.15107116, 3.44135668, 8.67190892, //
        5.18724514, -8.83376009, -0.94580758, 7.05526730, //
        -4.30181654, 3.14044721, -8.41133649, -8.17978794, //
        -2.62200144, 5.76253294, -5.51963398, -1.33870308, //
        8.85032955, 7.30250171, 9.27648467, 8.21075581, //
        3.11079555, 4.01937692, -1.96603822, -1.39290585, //
        -9.93193184, 6.86567177, 5.17027641, -7.62428403,
      ],
      [
      [
        -11.32172812, 0.00000000, 23.79233640, 1.43191377, //
        -30.73996043, -6.08192895, 9.73871288, 7.54734489, //
        9.11929520, -0.63707853, -6.08360435, -4.74925907, //
        1.00487170, 2.01707401, -0.50367733, -1.78342513, //
        -1.33422004, 0.00000000, -0.50367733, 1.78342513, //
        1.00487170, -2.01707401, -6.08360435, 4.74925907, //
        9.11929520, 0.63707853, 9.73871288, -7.54734489, //
        -30.73996043, 6.08192895, 23.79233640, -1.43191377,
      ],
      [
        23.01065878, 0.00000000, -8.74356823, -10.64970805, //
        -13.30189761, 7.55686220, 13.57283542, -5.42136401, //
        -4.43922167, 15.13186384, 0.84555324, -17.22088752, //
        1.83745521, 9.73595980, -0.83413428, -3.06063331, //
        -0.88470294, 0.00000000, -0.83413428, 3.06063331, //
        1.83745521, -9.73595980, 0.84555324, 17.22088752, //
        -4.43922167, -15.13186384, 13.57283542, 5.42136401, //
        -13.30189761, -7.55686220, -8.74356823, 10.64970805,
      ],
      [
        -1.31639599, 0.00000000, 7.91998594, 3.09798992, //
        -13.74115237, -11.44575747, 12.19442925, 2.34897272, //
        -10.47976374, 11.69696040, 0.90571663, -8.48061260, //
        6.64973857, 8.38699091, -7.12324239, -10.09620753, //
        8.66497221, 0.00000000, -7.12324239, 10.09620753, //
        6.64973857, -8.38699091, 0.90571663, 8.48061260, //
        -10.47976374, -11.69696040, 12.19442925, -2.34897272, //
        -13.74115237, 11.44575747, 7.91998594, -3.09798992,
      ],
      [
        -3.01387372, 0.00000000, 4.52971806, -8.99452483, //
        0.76931763, 10.66529259, -1.74584240, -17.81966452, //
        -18.38014078, 19.70388820, 27.59823252, -11.36996694, //
        -15.60876434, 5.13569852, -0.15010083, 2.24516116, //
        8.98903399, 0.00000000, -0.15010083, -2.24516116, //
        -15.60876434, -5.13569852, 27.59823252, 11.36996694, //
        -18.38014078, -19.70388820, -1.74584240, 17.81966452, //
        0.76931763, -10.66529259, 4.52971806, 8.99452483,
      ],
      [
        7.33212728, 0.00000000, -11.94346225, 3.84045448, //
        9.31984966, -8.70745635, 1.35471253, 15.11592107, //
        -0.33799658, -18.60559590, -4.38293097, 9.14581559, //
        -1.05819306, 7.29557148, 0.92660884, -8.19229784, //
        4.91069635, 0.00000000, 0.92660884, 8.19229784, //
        -1.05819306, -7.29557148, -4.38293097, -9.14581559, //
        -0.33799658, 18.60559590, 1.35471253, -15.11592107, //
        9.31984966, 8.70745635, -11.94346225, -3.84045448,
      ],
      [
        4.71085552, 0.00000000, -8.88891399, 14.33260086, //
        18.28732028, -17.25377932, -14.60390797, 9.10880403, //
        1.76578873, -1.99804409, 8.79607014, -7.23234299, //
        -17.90674555, 7.63335756, 10.69018010, 0.47566288, //
        -0.99043899, 0.00000000, 10.69018010, -0.47566288, //
        -17.90674555, -7.63335756, 8.79607014, 7.23234299, //
        1.76578873, 1.99804409, -14.60390797, -9.10880403, //
        18.28732028, 17.25377932, -8.88891399, -14.33260086,
      ],
      [
        3.09242503, 0.00000000, -4.56669435, -13.40193248, //
        8.55248674, 18.07871841, -4.47400630, -17.32315040, //
        -0.88324147, 8.64758071, -0.14106970, -9.52713167, //
        3.11257828, 11.06808319, -12.46482921, -2.70559262, //
        18.63712701, 0.00000000, -12.46482921, 2.70559262, //
        3.11257828, -11.06808319, -0.14106970, 9.52713167, //
        -0.88324147, -8.64758071, -4.47400630, 17.32315040, //
        8.55248674, -18.07871841, -4.56669435, 13.40193248,
      ],
      [
        -19.04392577, 0.00000000, 9.42316101, 9.65745667, //
        -2.22182092, -11.65774884, 1.41795814, 12.51063349, //
        9.84950110, -10.82397308, -17.41827756, 7.16801387, //
        4.34943674, -3.76564341, 9.30949988, 3.97517561, //
        -10.37499103, 0.00000000, 9.30949988, -3.97517561, //
        4.34943674, 3.76564341, -17.41827756, -7.16801387, //
        9.84950110, 10.82397308, 1.41795814, -12.51063349, //
        -2.22182092, 11.65774884, 9.42316101, -9.65745667,
      ],
      [
        -9.38823638, 0.00000000, 4.61007958, 11.08185771, //
        2.36216354, -14.14524850, -2.53696204, 5.43916290, //
        -2.22563424, 5.56546808, 3.32353055, -1.15423146, //
        7.52887500, -7.01763496, -17.70693547, 1.33364196, //
        18.67800253, 0.00000000, -17.70693547, -1.33364196, //
        7.52887500, 7.01763496, 3.32353055, 1.15423146, //
        -2.22563424, -5.56546808, -2.53696204, -5.43916290, //
        2.36216354, 14.14524850, 4.61007958, -11.08185771,
      ],
      [
        12.69710536, 0.00000000, -7.94097843, 11.59139408, //
        0.21402859, -13.69224662, 7.53884617, 1.96215139, //
        -14.93195139, 3.69988873, 11.44946277, 0.19414070, //
        -1.89322993, -4.20786021, -2.88099419, 7.73069239, //
        4.19252744, 0.00000000, -2.88099419, -7.73069239, //
        -1.89322993, 4.20786021, 11.44946277, -0.19414070, //
        -14.93195139, -3.69988873, 7.53884617, -1.96215139, //
        0.21402859, 13.69224662, -7.94097843, -11.59139408,
      ],
      [
        2.30075841, 0.00000000, 4.95420733, 0.70795537, //
        -2.47998695, -8.88994346, -7.49118180, 5.65266599, //
        3.41174311, -1.74597586, -0.02132183, -2.61580683, //
        -3.22682091, 12.67173312, 13.51841842, -12.35429550, //
        -19.63087314, 0.00000000, 13.51841842, 12.35429550, //
        -3.22682091, -12.67173312, -0.02132183, 2.61580683, //
        3.41174311, 1.74597586, -7.49118180, -5.65266599, //
        -2.47998695, 8.88994346, 4.95420733, -0.70795537,
      ],
      [
        -6.87260084, 0.00000000, 7.63756826, -7.16857242, //
        -7.71184313, 6.85580346, 5.20758977, -1.11468962, //
        2.75196700, -1.61999004, -9.74935731, -1.02502649, //
        6.20945145, 0.25049180, 0.80781169, 2.20762377, //
        -3.43377462, 0.00000000, 0.80781169, -2.20762377, //
        6.20945145, -0.25049180, -9.74935731, 1.02502649, //
        2.75196700, 1.61999004, 5.20758977, 1.11468962, //
        -7.71184313, -6.85580346, 7.63756826, 7.16857242,
      ],
      [
        8.21373151, 0.00000000, -9.37421861, -4.54782165, //
        5.40093749, 13.18054930, -0.50608985, -19.51835371, //
        0.40724536, 20.93948127, -4.65705049, -13.68597412, //
        11.90297749, 4.58786770, -5.98491412, -0.91107046, //
        -2.59150607, 0.00000000, -5.98491412, 0.91107046, //
        11.90297749, -4.58786770, -4.65705049, 13.68597412, //
        0.40724536, -20.93948127, -0.50608985, 19.51835371, //
        5.40093749, -13.18054930, -9.37421861, 4.54782165,
      ],
      [
        -11.41307539, 0.00000000, 14.15621659, 9.52206624, //
        -9.30104573, -10.72842952, -6.80635872, 11.71088636, //
        9.59194441, -14.78602010, -4.96671981, 16.88435769, //
        2.75039139, -4.90656284, 7.99027363, -7.03827468, //
        -15.41632813, 0.00000000, 7.99027363, 7.03827468, //
        2.75039139, 4.90656284, -4.96671981, -16.88435769, //
        9.59194441, 14.78602010, -6.80635872, -11.71088636, //
        -9.30104573, 10.72842952, 14.15621659, -9.52206624,
      ],
      [
        28.14625387, 0.00000000, -20.63031379, -20.59698764, //
        6.30490279, 19.54427017, 1.62477582, -0.44844758, //
        -1.69335975, -3.60807492, 2.97779816, -4.74264802, //
        -3.06393482, -2.45937742, 3.72051430, 8.38528594, //
        -6.62701931, 0.00000000, 3.72051430, -8.38528594, //
        -3.06393482, 2.45937742, 2.97779816, 4.74264802, //
        -1.69335975, 3.60807492, 1.62477582, 0.44844758, //
        6.30490279, -19.54427017, -20.63031379, 20.59698764,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        7.27601506, 8.15053386, 6.45755624, 5.81438270, //
        -2.10299669, 3.82395474, 3.16475381, 7.69026159, //
        9.79442858, 4.82224739, -3.18965493, -9.74178187, //
        3.13114791, 2.44823422, 1.79787108, -8.49109298, //
        -4.24844469, 8.39476604, 5.46657828, -6.35230361, //
        1.00804600, -0.90563243, -4.30190336, -0.57691755, //
        -5.07018310, 7.35903007, -2.81221961, -8.65806449, //
        1.27710472, 9.16450951, 1.05907201, -6.29749903, //
        7.22371548, -6.49615398, -3.12891193, 1.70914123, //
        -2.87996779, 3.60577342, 6.98343581, 8.48399701, //
        -2.27838832, 9.35757693, -8.92994334, -5.26522503, //
        4.46458699, -1.12358660, 7.00472473,
      ],
      [
      [
        23.44621069, 0.00000000, -18.05602802, -12.65126390, //
        18.54828148, 11.00742168, -19.16129332, -6.21222868, //
        7.99146142, -3.75205963, -1.16913798, 7.10645463, //
        0.98579363, 2.47901946, -0.36319149, -8.30535999, //
        -0.99798213, 0.00000000, -0.36319149, 8.30535999, //
        0.98579363, -2.47901946, -1.16913798, -7.10645463, //
        7.99146142, 3.75205963, -19.16129332, 6.21222868, //
        18.54828148, -11.00742168, -18.05602802, 12.65126390,
      ],
      [
        -1.78756343, 0.00000000, 8.23490851, -1.99249361, //
        0.61287451, -4.83259676, -23.95544278, -0.15723458, //
        22.16716029, 3.85945031, -3.76594819, -0.95057037, //
        -6.89685602, 3.14747042, 9.80054515, -3.73449174, //
        -10.60691950, 0.00000000, 9.80054515, 3.73449174, //
        -6.89685602, -3.14747042, -3.76594819, 0.95057037, //
        22.16716029, -3.85945031, -23.95544278, 0.15723458, //
        0.61287451, 4.83259676, 8.23490851, 1.99249361,
      ],
      [
        -1.85625759, 0.00000000, -2.84900940, -0.41182033, //
        11.73688220, 0.08076747, -15.97951305, -9.26599234, //
        7.70136769, 21.27932403, 0.37792340, -19.68548698, //
        0.06355885, 10.75268649, -3.17679838, -0.91463118, //
        6.10743498, 0.00000000, -3.17679838, 0.91463118, //
        0.06355885, -10.75268649, 0.37792340, 19.68548698, //
        7.70136769, -21.27932403, -15.97951305, 9.26599234, //
        11.73688220, -0.08076747, -2.84900940, 0.41182033,
      ],
      [
        -8.30668148, 0.00000000, 7.61618016, 0.55742730, //
        -1.37378776, -6.52034413, 3.26848432, 4.65250511, //
        -13.55511445, -0.11697143, 1.99542801, -1.87386728, //
        13.23143528, 8.14176310, -10.59763638, -8.03639456, //
        7.13670311, 0.00000000, -10.59763638, 8.03639456, //
        13.23143528, -8.14176310, 1.99542801, 1.87386728, //
        -13.55511445, 0.11697143, 3.26848432, -4.65250511, //
        -1.37378776, 6.52034413, 7.61618016, -0.55742730,
      ],
      [
        -1.18336489, 0.00000000, -1.67672534, 5.40697974, //
        0.80338856, -8.90765688, 1.25166831, 16.85630815, //
        3.55511330, -24.93548032, -5.05420454, 21.91212221, //
        2.33161000, -3.38455531, 0.42665827, -10.72045857, //
        -2.09165224, 0.00000000, 0.42665827, 10.72045857, //
        2.33161000, 3.38455531, -5.05420454, -21.91212221, //
        3.55511330, 24.93548032, 1.25166831, -16.85630815, //
        0.80338856, 8.90765688, -1.67672534, -5.40697974,
      ],
      [
        -0.60464258, 0.00000000, 5.61017191, -2.92340325, //
        -10.33312451, 4.15161603, 0.14903589, 1.55785375, //
        5.36170888, 6.99759877, 7.96556509, -18.48574757, //
        -15.13121666, 14.50944202, 11.97592991, -7.70513766, //
        -10.59149846, 0.00000000, 11.97592991, 7.70513766, //
        -15.13121666, -14.50944202, 7.96556509, 18.48574757, //
        5.36170888, -6.99759877, 0.14903589, -1.55785375, //
        -10.33312451, -4.15161603, 5.61017191, 2.92340325,
      ],
      [
        13.47051998, 0.00000000, -17.17188806, 5.10289548, //
        17.11818413, -6.38689092, -6.50750587, 3.31601102, //
        5.01962919, -1.32256365, -15.37031203, 0.75130542, //
        6.32249405, -2.59044018, 11.42117236, 7.96712350, //
        -15.13406752, 0.00000000, 11.42117236, -7.96712350, //
        6.32249405, 2.59044018, -15.37031203, -0.75130542, //
        5.01962919, 1.32256365, -6.50750587, -3.31601102, //
        17.11818413, 6.38689092, -17.17188806, -5.10289548,
      ],
      [
        7.34932602, 0.00000000, 4.65142109, -3.79137556, //
        -16.60425094, -5.95246242, 11.72817792, 8.47768966, //
        -8.74012596, -4.75616883, 8.62177874, 13.11213844, //
        -3.18195751, -23.37281795, -4.17059323, 19.58470559, //
        8.04177374, 0.00000000, -4.17059323, -19.58470559, //
        -3.18195751, 23.37281795, 8.62177874, -13.11213844, //
        -8.74012596, 4.75616883, 11.72817792, -8.47768966, //
        -16.60425094, 5.95246242, 4.65142109, 3.79137556,
      ],
      ],
    );
  });
}

