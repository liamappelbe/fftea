// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';

import 'package:fftea/fftea.dart';
import 'package:fftea/impl.dart';
import 'package:test/test.dart';

import 'util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        -5.03131418, -5.72862467, 1.45008285, 3.60013221, //
        -1.23366639, -1.66822526, -3.52525182, -5.88450490, //
        -5.02301856, 1.73572287, 5.26410820, 1.98926260, //
        8.01704465, -3.02758430, 7.41230476, 9.66626969,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        -0.40250513, -0.68611216, 0.33670912, 1.43232046, //
        -0.72549835, -1.28453345, -3.21555075, -5.82535325, //
        -4.97252666, 1.58323583, 4.05336332, 1.16985171, //
        3.18959871, -0.70300484, 0.88776499, 0.77330157,
      ],
    );
    final b = [
        5.26308779, -7.32739713, -2.01750034, 5.35856515, //
        7.04074071, -4.46752376, 1.90474044, -0.19202391, //
        -5.21624078, 5.21366126, -9.00452899, -5.17254636, //
        -7.19927792, -2.54072514, 7.74313716, -8.52577771, //
        -0.54289599, 9.87716202, 3.78343949, -7.98639953, //
        4.09443099, 2.96318965, -6.30185259, -0.11122356, //
        -2.88891534, -3.70319747, -4.31994904, 5.12968550, //
        1.42336121, 7.04085558, -6.76304003, -3.62629257,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        0.42104702, -0.58619177, -0.24163418, 0.64179047, //
        1.63485944, -1.03735867, 0.75780514, -0.07639713, //
        -3.06758301, 3.06606604, -6.93348732, -3.98286070, //
        -6.56680564, -2.31751689, 7.66530234, -8.44007571, //
        -0.53743874, 9.77787576, 3.45105607, -7.28477690, //
        3.15271186, 2.28165603, -3.70601296, -0.06540869, //
        -1.14936127, -1.47332520, -1.00309183, 1.19111257, //
        0.17047468, 0.84327686, -0.54104320, -0.29010341,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        4.54086735, 7.90859665, -9.16189641, -2.77410622, //
        7.32124389, 0.99009345, 1.16315676, 8.63885414, //
        8.84235184, 8.03891181, 0.22149683, 1.78938702, //
        -7.54489601, 5.10490936, 9.48711668, 6.21718935, //
        1.28724981, 7.40189116, 5.08213979, -9.80970749, //
        -8.88402727, -6.06829145, -7.43407601, 7.46986328, //
        6.50606183, 5.57298387, -7.16770562, -8.42783329, //
        0.14433890, 9.85721382, -8.29401286, 4.39213460, //
        3.94363849, 5.63300129, -5.26421338, 4.87563035, //
        -6.71535268, 7.57920561, -6.55907703, 2.88324199, //
        3.31722046, 6.42028896, 7.69329681, 0.64440547, //
        9.74843323, -5.68846883, -6.18258632, -8.50332665, //
        8.13505399, 0.28500875, -1.50435239, -3.99205466, //
        5.82573015, 3.47608472, -1.06856458, -6.12206099, //
        -8.34808604, -8.07570578, 6.08458407, -4.22773537, //
        4.79998141, -7.39630821, 4.36975281, 8.74069699, //
        -7.19870032, -2.62657974, -8.06834884, 9.58785026, //
        1.96544464, 6.10103585, 9.66211803, -5.04948118, //
        -8.02084781, -8.72988626, 4.00996761, -5.32425093, //
        -3.93461540, -1.35523696, -0.71398779, -9.66531398, //
        -9.33092543, 0.31248999, 5.42255768, 1.69566685, //
        3.13409837, -2.66651584, 5.77506057, -2.18481944, //
        -8.67425117, -9.96513238, -0.15349383, -1.37044638, //
        6.36020641, -3.72553007, -9.75965765, -4.42343279, //
        -4.40251655, 4.06543573, -9.69937885, -1.67992021, //
        -6.69834734, -5.60267761, -2.56169001, -5.73756958, //
        -4.68662038, 2.60549999, -7.94703351, 3.77598272, //
        3.05634702, -0.24515676, -8.01158843, 6.17591044, //
        2.97305222, 6.59203945, 9.37993280, 5.09069393, //
        9.81813764, 2.77421588, 1.49033278, -3.08285617, //
        -7.48020539, -7.37569805, 7.38915044, -4.43196482, //
        8.61524192, 2.16295660, 1.64099009, 6.34092192,
      ],
      [
      [
        28.06939555, 0.00000000, -25.39082843, -4.64008064, //
        17.59101081, 4.57150022, -11.31988611, 5.10913880, //
        10.06968781, -0.62598170, -2.88523982, -9.66132739, //
        -2.97266108, -1.05202032, 4.61300021, 7.18928754, //
        -7.47956232, 0.00000000, 4.61300021, -7.18928754, //
        -2.97266108, 1.05202032, -2.88523982, 9.66132739, //
        10.06968781, 0.62598170, -11.31988611, -5.10913880, //
        17.59101081, -4.57150022, -25.39082843, 4.64008064,
      ],
      [
        17.36240014, 0.00000000, -21.32265740, -12.49348053, //
        19.23357388, 9.17096484, 1.79723233, -0.38080205, //
        -18.07101800, -8.51742320, 13.58508158, 9.06551877, //
        -2.21493951, 0.34781539, 0.84760326, -7.43684076, //
        -5.07215242, 0.00000000, 0.84760326, 7.43684076, //
        -2.21493951, -0.34781539, 13.58508158, -9.06551877, //
        -18.07101800, 8.51742320, 1.79723233, 0.38080205, //
        19.23357388, -9.17096484, -21.32265740, 12.49348053,
      ],
      [
        -8.25425074, 0.00000000, -5.87545476, 8.58333024, //
        28.05911459, 2.50849933, -26.84616544, -9.19666085, //
        13.19624209, -3.09559681, -3.81770141, 0.50485413, //
        -5.47623874, 7.60389033, 10.79942041, -1.53994820, //
        -11.82418277, 0.00000000, 10.79942041, 1.53994820, //
        -5.47623874, -7.60389033, -3.81770141, -0.50485413, //
        13.19624209, 3.09559681, -26.84616544, 9.19666085, //
        28.05911459, -2.50849933, -5.87545476, -8.58333024,
      ],
      [
        6.84849515, 0.00000000, -9.83519634, 0.45234888, //
        7.02657229, 2.91618784, -3.62861297, 6.22657999, //
        14.57964878, -9.85773964, -18.28753513, -4.87491987, //
        5.25529487, 8.21936558, 16.14914643, -1.04990898, //
        -29.36713099, 0.00000000, 16.14914643, 1.04990898, //
        5.25529487, -8.21936558, -18.28753513, 4.87491987, //
        14.57964878, 9.85773964, -3.62861297, -6.22657999, //
        7.02657229, -2.91618784, -9.83519634, -0.45234888,
      ],
      [
        17.32556877, 0.00000000, -13.77254926, 9.46775924, //
        5.11979899, -11.44981334, -0.91806813, 7.17467339, //
        4.24123579, -5.90192923, -4.26449985, 3.92417931, //
        2.12344919, 10.74835927, 5.83121384, -22.08933458, //
        -14.04672992, 0.00000000, 5.83121384, 22.08933458, //
        2.12344919, -10.74835927, -4.26449985, -3.92417931, //
        4.24123579, 5.90192923, -0.91806813, -7.17467339, //
        5.11979899, 11.44981334, -13.77254926, -9.46775924,
      ],
      [
        -3.59971121, 0.00000000, 8.14328667, 4.29420747, //
        -0.90717196, -13.31708701, -17.15489828, 12.42296353, //
        20.93653907, -7.23648780, -10.17621316, 1.23330883, //
        2.20660698, -1.75135316, -12.99685029, 6.58843564, //
        23.49711314, 0.00000000, -12.99685029, -6.58843564, //
        2.20660698, 1.75135316, -10.17621316, -1.23330883, //
        20.93653907, 7.23648780, -17.15489828, -12.42296353, //
        -0.90717196, 13.31708701, 8.14328667, -4.29420747,
      ],
      [
        -15.52223022, 0.00000000, 16.92497020, -2.24394006, //
        -20.92262520, -0.61298907, 18.61615473, 6.44478542, //
        -6.91811074, -3.86045130, 3.06921778, -5.11283616, //
        -5.34251154, 9.57140938, -5.58284995, -7.56560326, //
        15.83373964, 0.00000000, -5.58284995, 7.56560326, //
        -5.34251154, -9.57140938, 3.06921778, 5.11283616, //
        -6.91811074, 3.86045130, 18.61615473, -6.44478542, //
        -20.92262520, 0.61298907, 16.92497020, 2.24394006,
      ],
      [
        0.75215376, 0.00000000, 3.42030332, -1.24701784, //
        -5.76616638, 11.53454267, 2.28003604, -20.47222711, //
        -3.11562865, 19.74233705, 6.97770866, -9.43555042, //
        -15.13373033, -7.29506903, 15.80213552, 17.67691335, //
        -9.68147012, 0.00000000, 15.80213552, -17.67691335, //
        -15.13373033, 7.29506903, 6.97770866, 9.43555042, //
        -3.11562865, -19.74233705, 2.28003604, 20.47222711, //
        -5.76616638, -11.53454267, 3.42030332, 1.24701784,
      ],
      [
        -6.10625146, 0.00000000, 11.02165415, -16.85455992, //
        -20.19473144, 11.98207772, 20.75243338, 0.96730935, //
        -18.58843681, -0.96395960, 13.65799312, 2.33990557, //
        4.87617342, -2.08974879, -13.69923897, -5.70267985, //
        10.45455774, 0.00000000, -13.69923897, 5.70267985, //
        4.87617342, 2.08974879, 13.65799312, -2.33990557, //
        -18.58843681, 0.96395960, 20.75243338, -0.96730935, //
        -20.19473144, -11.98207772, 11.02165415, 16.85455992,
      ],
      [
        -17.99999616, 0.00000000, 14.83558230, 13.30264483, //
        -13.29635381, -12.21134744, 16.44135168, 7.94342123, //
        -14.65325500, -8.91045488, 5.56356015, 8.37525078, //
        -2.98130795, -1.95839954, 0.07540139, 0.71146754, //
        6.03003864, 0.00000000, 0.07540139, -0.71146754, //
        -2.98130795, 1.95839954, 5.56356015, -8.37525078, //
        -14.65325500, 8.91045488, 16.44135168, -7.94342123, //
        -13.29635381, 12.21134744, 14.83558230, -13.30264483,
      ],
      [
        -13.01577540, 0.00000000, 16.68290858, -6.83092826, //
        -18.42886309, 7.12669320, 13.61843899, -11.53332900, //
        -10.23489367, 9.28429994, 10.09295073, -1.18486204, //
        -6.58658146, -0.91280516, -6.07640002, 1.65135132, //
        14.88065526, 0.00000000, -6.07640002, -1.65135132, //
        -6.58658146, 0.91280516, 10.09295073, 1.18486204, //
        -10.23489367, -9.28429994, 13.61843899, 11.53332900, //
        -18.42886309, -7.12669320, 16.68290858, 6.83092826,
      ],
      [
        -25.64538489, 0.00000000, 16.77935251, -0.23706492, //
        -2.72879292, -8.66809296, -8.97793779, 14.16126467, //
        13.08223413, -5.30176977, -4.89270888, 0.43198411, //
        -8.37661946, -5.39109136, 14.50894926, 9.34060089, //
        -13.14356880, 0.00000000, 14.50894926, -9.34060089, //
        -8.37661946, 5.39109136, -4.89270888, -0.43198411, //
        13.08223413, 5.30176977, -8.97793779, -14.16126467, //
        -2.72879292, 8.66809296, 16.77935251, 0.23706492,
      ],
      [
        -23.38707634, 0.00000000, 12.90920874, 12.38261321, //
        -2.27834978, -4.96604983, 0.11717159, -1.79638900, //
        2.94954927, -2.45980665, 0.20675675, 11.08678228, //
        -1.70584563, -14.76904871, 5.30851663, 6.24498620, //
        -11.62693880, 0.00000000, 5.30851663, -6.24498620, //
        -1.70584563, 14.76904871, 0.20675675, -11.08678228, //
        2.94954927, 2.45980665, 0.11717159, 1.79638900, //
        -2.27834978, 4.96604983, 12.90920874, -12.38261321,
      ],
      [
        23.13334771, 0.00000000, -15.05376232, 14.66501414, //
        3.37074118, -15.59477451, -5.98411803, 8.30810603, //
        9.48245460, 3.87414097, 1.57191401, -10.43103595, //
        -7.64959359, 10.20994811, 7.70369412, -10.89081580, //
        -10.01600762, 0.00000000, 7.70369412, 10.89081580, //
        -7.64959359, -10.20994811, 1.57191401, 10.43103595, //
        9.48245460, -3.87414097, -5.98411803, -8.30810603, //
        3.37074118, 15.59477451, -15.05376232, -14.66501414,
      ],
      [
        1.82687518, 0.00000000, 13.86832472, -7.50043498, //
        -23.70635015, -1.10353544, 12.65735386, 3.02337586, //
        -7.51235941, 0.20993929, 9.58851335, -5.70483115, //
        -7.88799842, 10.24581454, -6.52029125, -6.44578855, //
        17.19873943, 0.00000000, -6.52029125, 6.44578855, //
        -7.88799842, -10.24581454, 9.58851335, 5.70483115, //
        -7.51235941, -0.20993929, 12.65735386, -3.02337586, //
        -23.70635015, 1.10353544, 13.86832472, 7.50043498,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        0.81285992, -3.87798339, 0.00339844, 6.24981551, //
        -8.34190912, 1.08333941, -8.95227947, 6.69827220, //
        1.30699861, 9.05981860, 9.37743302, 0.35866445, //
        -3.77916970, -3.96307656, -8.16209584, -2.20874773, //
        -0.36067127, 0.44051063, 1.49817126, -4.24462773, //
        -9.77426494, 0.17982810, -4.98343972, 7.23492292, //
        3.74034546, -6.21845213, -6.21972658, -9.84580181, //
        -8.06585517, -7.88196462, 5.82877748, -4.68689902, //
        3.36079272, 8.33401520, -2.79257034, -6.09726408, //
        2.42989151, 2.61833377, 6.41970101, 7.17839700, //
        1.88186196, 6.85763323, -9.70956847, -9.03599371, //
        -5.68464356, -1.11813052, 4.81086981,
      ],
      [
      [
        11.12985173, 0.00000000, -14.44707944, 11.24679029, //
        15.78813545, -18.03117357, -7.98717693, 10.06505612, //
        -3.20328997, 0.79849879, 4.39471440, -4.23038546, //
        -1.37748119, 12.93657635, 12.86866965, -16.25371933, //
        -23.20283566, 0.00000000, 12.86866965, 16.25371933, //
        -1.37748119, -12.93657635, 4.39471440, 4.23038546, //
        -3.20328997, -0.79849879, -7.98717693, -10.06505612, //
        15.78813545, 18.03117357, -14.44707944, -11.24679029,
      ],
      [
        -3.14592159, 0.00000000, 13.08453600, -15.28194312, //
        -22.53928924, 8.51020915, 12.09907072, 2.37293743, //
        1.64333404, -2.99676329, -7.45110153, -2.70136901, //
        4.38852597, 7.13147808, -2.05340442, -0.95136525, //
        4.80257850, 0.00000000, -2.05340442, 0.95136525, //
        4.38852597, -7.13147808, -7.45110153, 2.70136901, //
        1.64333404, 2.99676329, 12.09907072, -2.37293743, //
        -22.53928924, -8.51020915, 13.08453600, 15.28194312,
      ],
      [
        -17.98566792, 0.00000000, 7.29354591, 0.74049960, //
        6.53839961, 11.37620561, -6.53939684, -12.80025119, //
        3.37288207, 3.44925215, -6.59722228, 1.56452661, //
        8.88394361, -4.20651278, -0.08413456, 3.96168738, //
        -7.75036712, 0.00000000, -0.08413456, -3.96168738, //
        8.88394361, 4.20651278, -6.59722228, -1.56452661, //
        3.37288207, -3.44925215, -6.53939684, 12.80025119, //
        6.53839961, -11.37620561, 7.29354591, -0.74049960,
      ],
      [
        -16.50275171, 0.00000000, 1.05856156, 0.31232244, //
        19.98758092, -5.51792821, -18.75525879, 4.26390214, //
        6.17909891, -2.54882915, -1.54333767, 9.55953424, //
        5.81575836, -14.34373537, -9.38345592, 9.83789372, //
        9.78485698, 0.00000000, -9.38345592, -9.83789372, //
        5.81575836, 14.34373537, -1.54333767, -9.55953424, //
        6.17909891, 2.54882915, -18.75525879, -4.26390214, //
        19.98758092, 5.51792821, 1.05856156, -0.31232244,
      ],
      [
        -27.18396438, 0.00000000, 28.04650368, 8.53960221, //
        -20.74044564, -13.40406865, 3.93376363, 10.50920322, //
        -2.55158022, 0.57960740, 11.58460678, -6.43350108, //
        -1.66857509, 5.18325137, -11.65396999, -4.78496737, //
        13.28335808, 0.00000000, -11.65396999, 4.78496737, //
        -1.66857509, -5.18325137, 11.58460678, 6.43350108, //
        -2.55158022, -0.57960740, 3.93376363, -10.50920322, //
        -20.74044564, 13.40406865, 28.04650368, -8.53960221,
      ],
      [
        -0.81799299, 0.00000000, -6.77634350, 5.01375740, //
        9.24498184, 11.46315898, -7.07820312, -9.59198387, //
        14.92546380, -0.75952922, -20.00547664, -1.34747014, //
        14.13756046, 6.91766334, 0.88819893, -7.77188569, //
        -9.85437053, 0.00000000, 0.88819893, 7.77188569, //
        14.13756046, -6.91766334, -20.00547664, 1.34747014, //
        14.92546380, 0.75952922, -7.07820312, 9.59198387, //
        9.24498184, -11.46315898, -6.77634350, -5.01375740,
      ],
      [
        14.85104864, 0.00000000, -16.43025522, 2.31842906, //
        17.10213336, -11.63653809, -9.57511922, 2.95721640, //
        -2.46676612, 9.03377803, 1.54148497, 1.57857494, //
        5.39060302, -11.60601348, -0.93434282, 8.18913436, //
        -4.10652457, 0.00000000, -0.93434282, -8.18913436, //
        5.39060302, 11.60601348, 1.54148497, -1.57857494, //
        -2.46676612, -9.03377803, -9.57511922, -2.95721640, //
        17.10213336, 11.63653809, -16.43025522, -2.31842906,
      ],
      [
        -7.52957052, 0.00000000, 18.46232934, -8.48091625, //
        -27.69888578, 0.93005857, 19.81646922, 3.07622360, //
        -10.77024563, -1.10328196, 5.03158445, 5.71808790, //
        1.89561269, -12.28638576, -7.56132445, 10.01843567, //
        9.17849084, 0.00000000, -7.56132445, -10.01843567, //
        1.89561269, 12.28638576, 5.03158445, -5.71808790, //
        -10.77024563, 1.10328196, 19.81646922, -3.07622360, //
        -27.69888578, -0.93005857, 18.46232934, 8.48091625,
      ],
      ],
    );
  });
}

