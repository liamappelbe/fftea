// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';
import 'package:fftea/fftea.dart';
import 'package:test/test.dart';
import 'util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        -2.10391426, 9.88231860, -2.59149069, -1.05315267, //
        -5.27358617, -7.89252146, 3.48335867, -2.02939081, //
        4.83258011, 1.90523397, -4.94540026, 8.13357230, //
        -2.60325914, 8.93014407, -3.98637351, -6.15869770,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        -0.16831314, 1.18359630, -0.60174393, -0.41899909, //
        -3.10130687, -6.07724152, 3.17733801, -2.00899116, //
        4.78400252, 1.73785501, -3.80795820, 4.78321635, //
        -1.03571233, 2.07357875, -0.47744433, -0.49269582,
      ],
    );
    final b = [
        1.09926635, 8.95024173, 5.04129526, 2.82381123, //
        2.24532521, -7.61714474, 0.86345686, -3.04850058, //
        -2.35333455, -5.50116156, 0.06029352, 3.57165427, //
        -4.06390411, 4.98978160, -3.90705543, 7.99829382, //
        -1.64447674, 3.52655760, 8.18982111, 9.20271607, //
        -9.47239246, 8.36482940, -4.40717574, 4.21872690, //
        -8.85874472, -1.25168320, 0.76255217, -5.31567051, //
        -0.72135599, 3.45548099, 3.39561204, -0.53492660,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        0.08794131, 0.71601934, 0.60379134, 0.33820530, //
        0.52136434, -1.76870041, 0.34352820, -1.21285261, //
        -1.38395626, -3.23514011, 0.04642601, 2.75017379, //
        -3.70688126, 4.55141840, -3.86778130, 7.91789415, //
        -1.62794629, 3.49110828, 7.47032745, 8.39423737, //
        -7.29374219, 6.44091864, -2.59178554, 2.48096197, //
        -3.52447092, -0.49798489, 0.17706455, -1.23429827, //
        -0.08639615, 0.41385981, 0.27164896, -0.04279413,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        4.86406049, 9.75819143, -6.51540982, 6.33413431, //
        -3.92004710, -9.59469675, 1.32263966, 4.00130714, //
        -1.96927655, -8.80025642, -1.74061784, -8.42045427, //
        2.77913785, -6.38703968, 4.47373706, 0.64041321, //
        6.39757049, 0.97148568, 5.95557151, 2.92995957, //
        4.62961102, -9.16145918, -9.28695513, -8.65620333, //
        -1.48968157, -7.11466437, -4.60861516, -4.17941519, //
        -9.05075153, 5.78715761, 9.13374972, 5.08946657, //
        3.79883375, -0.82246419, 6.18092232, 5.04573024, //
        4.24154187, 2.74901866, -9.36247320, -9.57040337, //
        -2.34611081, 4.96856583, 8.53435317, -0.59643034, //
        -7.20995893, 2.32787617, -3.25416260, -5.18041109, //
        3.90936646, 8.90679427, 8.02269050, -9.61620643, //
        -2.85971377, 6.42826862, 7.35259007, -1.15501007, //
        2.98004538, -3.75397477, -4.68483571, 8.17250400, //
        4.30912064, -7.42136354, 8.63285697, -4.10418531, //
        8.95058163, 0.58640526, 6.62477209, -1.46374702, //
        9.71422630, 1.67179077, 0.21282224, 3.89854898, //
        8.93294274, 5.11337188, 8.66670980, -1.09023173, //
        -9.81771977, -5.37914367, 5.38000761, 8.30520308, //
        3.44402104, -4.39405618, 4.71871689, -4.75956615, //
        4.03280795, 0.78302275, -1.04395056, 4.64215276, //
        -6.12495933, 8.07753566, -4.91789039, 9.68961662, //
        2.99634073, -7.49962947, -9.27107295, 0.40385483, //
        4.51564463, 5.42562034, 4.28294994, 5.89945769, //
        -2.52828982, -1.16371266, -8.76249996, 5.65715625, //
        -9.04389421, 9.45209891, -6.23388829, -5.16126078, //
        3.40637865, -6.69978956, -1.32636045, -6.14278207, //
        6.47298969, -5.83409354, -1.71990138, 1.20330647, //
        -2.19641548, -7.71421000, 1.83630097, -4.00364679, //
        0.94846848, 1.70955210, 7.10736063, -7.46807444, //
        -0.36072266, 2.45848995, 7.18905258, 0.18772727,
      ],
      [
      [
        -18.44119044, 0.00000000, 10.45336665, -3.11319220, //
        4.30153544, 7.80706651, -7.80112289, -15.12761532, //
        -2.15888116, 17.28640918, 12.79317121, -7.13722848, //
        -5.78758855, 0.26093753, -7.65437559, -7.62308661, //
        10.14898022, 0.00000000, -7.65437559, 7.62308661, //
        -5.78758855, -0.26093753, 12.79317121, 7.13722848, //
        -2.15888116, -17.28640918, -7.80112289, 15.12761532, //
        4.30153544, -7.80706651, 10.45336665, 3.11319220,
      ],
      [
        10.82051796, 0.00000000, -15.06275585, 7.72903455, //
        9.36548858, -3.98411229, 0.61261887, -2.25543509, //
        1.63817555, 5.14992939, -0.25348738, -2.55976409, //
        -2.97876925, -2.91683909, -10.60705306, 7.16601419, //
        23.75104715, 0.00000000, -10.60705306, -7.16601419, //
        -2.97876925, 2.91683909, -0.25348738, 2.55976409, //
        1.63817555, -5.14992939, 0.61261887, 2.25543509, //
        9.36548858, 3.98411229, -15.06275585, -7.72903455,
      ],
      [
        -34.68456688, 0.00000000, 28.99377675, 2.35704216, //
        -6.37999864, -10.33265102, -12.43145204, 8.96245779, //
        8.43291176, 2.44948812, -3.34122528, -8.56140218, //
        4.57356697, 0.73554809, -7.32747937, 7.56808747, //
        9.64436658, 0.00000000, -7.32747937, -7.56808747, //
        4.57356697, -0.73554809, -3.34122528, 8.56140218, //
        8.43291176, -2.44948812, -12.43145204, -8.96245779, //
        -6.37999864, 10.33265102, 28.99377675, -2.35704216,
      ],
      [
        22.07460406, 0.00000000, -21.05576867, 2.37820825, //
        5.76622536, 10.72785780, 11.92662727, -13.96059895, //
        -11.50576969, 2.63280404, 0.44876287, 3.58891170, //
        8.81440784, 2.76071145, -6.34892920, -5.92757318, //
        1.83428439, 0.00000000, -6.34892920, 5.92757318, //
        8.81440784, -2.76071145, 0.44876287, -3.58891170, //
        -11.50576969, -2.63280404, 11.92662727, 13.96059895, //
        5.76622536, -10.72785780, -21.05576867, -2.37820825,
      ],
      [
        -4.80133850, 0.00000000, 9.11808597, 6.75011669, //
        -8.44258851, -25.14799595, 1.75797837, 28.88998056, //
        -1.28320317, -14.95739807, -1.28830738, -0.16008465, //
        4.09869041, 6.91682209, -0.30585003, -2.96622289, //
        -2.50827281, 0.00000000, -0.30585003, 2.96622289, //
        4.09869041, -6.91682209, -1.28830738, 0.16008465, //
        -1.28320317, 14.95739807, 1.75797837, -28.88998056, //
        -8.44258851, 25.14799595, 9.11808597, -6.75011669,
      ],
      [
        4.14001048, 0.00000000, -5.63544486, 8.17122074, //
        12.97630440, -13.63862405, -8.04194999, 16.76157679, //
        -5.90646798, -21.72097180, 2.20919304, 11.62441278, //
        4.69661796, 6.47033859, -3.99840596, -8.94112574, //
        3.26029632, 0.00000000, -3.99840596, 8.94112574, //
        4.69661796, -6.47033859, 2.20919304, -11.62441278, //
        -5.90646798, 21.72097180, -8.04194999, -16.76157679, //
        12.97630440, 13.63862405, -5.63544486, -8.17122074,
      ],
      [
        8.32582999, 0.00000000, -4.72845797, -4.15247584, //
        -3.28165144, 12.22973715, 12.77989790, -14.05088212, //
        -1.98032789, -0.53429094, -16.64342442, 7.80873989, //
        9.35772719, -6.19036376, -3.19795475, 5.43481738, //
        7.06255278, 0.00000000, -3.19795475, -5.43481738, //
        9.35772719, 6.19036376, -16.64342442, -7.80873989, //
        -1.98032789, 0.53429094, 12.77989790, 14.05088212, //
        -3.28165144, -12.22973715, -4.72845797, 4.15247584,
      ],
      [
        19.63447594, 0.00000000, -11.69294433, 3.38375617, //
        2.82202807, -4.67168767, -6.74143740, 1.11431014, //
        2.57750474, 2.87712940, 8.18842744, 5.97429860, //
        3.41163182, -11.91998271, -25.16518887, 4.33810686, //
        33.56548113, 0.00000000, -25.16518887, -4.33810686, //
        3.41163182, 11.91998271, 8.18842744, -5.97429860, //
        2.57750474, -2.87712940, -6.74143740, -1.11431014, //
        2.82202807, 4.67168767, -11.69294433, -3.38375617,
      ],
      [
        26.59181027, 0.00000000, -21.22379192, -6.69214785, //
        13.40337439, -6.69203482, -6.38676048, 14.15076666, //
        2.78715851, -2.26623858, -3.69807487, -11.06191096, //
        0.32154292, 7.64983906, -4.03273124, 3.12220846, //
        11.06675508, 0.00000000, -4.03273124, -3.12220846, //
        0.32154292, -7.64983906, -3.69807487, 11.06191096, //
        2.78715851, 2.26623858, -6.38676048, -14.15076666, //
        13.40337439, 6.69203482, -21.22379192, 6.69214785,
      ],
      [
        6.72267619, 0.00000000, -9.62574057, 1.84844061, //
        15.47561728, 7.67477073, -5.91025561, -20.99651289, //
        -10.41623125, 12.86749749, 9.02051934, -3.39749796, //
        -0.60548616, 7.97812417, -7.11008706, -7.81364983, //
        11.62065187, 0.00000000, -7.11008706, 7.81364983, //
        -0.60548616, -7.97812417, 9.02051934, 3.39749796, //
        -10.41623125, -12.86749749, -5.91025561, 20.99651289, //
        15.47561728, -7.67477073, -9.62574057, -1.84844061,
      ],
      [
        7.71264084, 0.00000000, -4.94165279, 1.91811879, //
        -3.20092178, -3.30574497, 6.03983880, -0.87779546, //
        1.45715267, 1.83544597, -1.01259024, 2.28985171, //
        -15.43992350, -6.43125088, 24.14655142, 9.85362725, //
        -21.80955000, 0.00000000, 24.14655142, -9.85362725, //
        -15.43992350, 6.43125088, -1.01259024, -2.28985171, //
        1.45715267, -1.83544597, 6.03983880, 0.87779546, //
        -3.20092178, 3.30574497, -4.94165279, -1.91811879,
      ],
      [
        5.32628535, 0.00000000, -4.11847614, 12.50763920, //
        7.12697268, -23.38213203, -14.28019283, 12.83455175, //
        11.61349543, 7.56573294, -0.28266195, -9.23892839, //
        0.24310059, -1.05580008, 0.81610775, 0.54725690, //
        -7.56297640, 0.00000000, 0.81610775, -0.54725690, //
        0.24310059, 1.05580008, -0.28266195, 9.23892839, //
        11.61349543, -7.56573294, -14.28019283, -12.83455175, //
        7.12697268, 23.38213203, -4.11847614, -12.50763920,
      ],
      [
        -9.52839208, 0.00000000, 7.24510167, 0.63655964, //
        3.41727210, -7.09757396, -10.04783014, 3.65716254, //
        2.78547034, -2.01969858, 9.19628450, 5.28992903, //
        -20.86861143, 0.93487187, 29.38675924, -8.02330954, //
        -32.70050049, 0.00000000, 29.38675924, 8.02330954, //
        -20.86861143, -0.93487187, 9.19628450, -5.28992903, //
        2.78547034, 2.01969858, -10.04783014, -3.65716254, //
        3.41727210, 7.09757396, 7.24510167, -0.63655964,
      ],
      [
        -14.28064308, 0.00000000, 6.04887208, 3.95547874, //
        2.78776286, -3.31728293, -4.19065779, 1.35078819, //
        10.96619618, 3.97514547, -10.78851759, -5.37248525, //
        7.77200974, -5.71908581, -16.67875473, 7.79246120, //
        22.44682157, 0.00000000, -16.67875473, -7.79246120, //
        7.77200974, 5.71908581, -10.78851759, 5.37248525, //
        10.96619618, -3.97514547, -4.19065779, -1.35078819, //
        2.78776286, 3.31728293, 6.04887208, -3.95547874,
      ],
      [
        -5.13516682, 0.00000000, 0.24074034, 7.83425490, //
        6.81660828, -7.97051992, -5.10130348, 6.61510075, //
        -7.41722506, -3.58369488, 13.07542764, 2.76042082, //
        -2.26514099, -1.82196760, -11.96728579, -0.37392540, //
        18.37152495, 0.00000000, -11.96728579, 0.37392540, //
        -2.26514099, 1.82196760, 13.07542764, -2.76042082, //
        -7.41722506, 3.58369488, -5.10130348, -6.61510075, //
        6.81660828, 7.97051992, 0.24074034, -7.83425490,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        5.94814379, -8.62981364, 4.53479863, -8.69360784, //
        1.27358606, 3.73503741, -3.14753685, 5.75201123, //
        -4.02675597, -3.35999343, -6.96856990, -6.11859462, //
        -4.07479884, 5.63551854, 3.15117231, 6.74496366, //
        -9.24347324, 8.72230115, -8.73068674, -9.82809801, //
        7.33994601, 8.17570940, -4.27510757, -9.92234788, //
        -3.86145799, -0.43786332, 5.72935418, 7.95562391, //
        -0.15839987, -7.81252846, -7.93189455, -8.83356739, //
        -5.40539713, 9.29489637, 6.22798365, -0.44860965, //
        0.31869874, -9.40498511, -1.17920674, 4.19934790, //
        -4.29451431, -2.79211337, 2.03806738, 4.12550125, //
        -3.47809671, 7.44162911, -6.24616036,
      ],
      [
      [
        -12.24626534, 0.00000000, 6.95384849, -9.49890405, //
        0.20492835, 15.35434284, -2.12990297, -6.86585511, //
        2.49976046, -1.01488745, -2.57569371, -6.85480625, //
        -6.76154131, 11.82342856, 13.68278350, -1.04319758, //
        -11.50210029, 0.00000000, 13.68278350, 1.04319758, //
        -6.76154131, -11.82342856, -2.57569371, 6.85480625, //
        2.49976046, 1.01488745, -2.12990297, 6.86585511, //
        0.20492835, -15.35434284, 6.95384849, 9.49890405,
      ],
      [
        -7.69994684, 0.00000000, -1.03221491, 14.13458480, //
        12.79582080, -16.86209207, -12.80832220, 8.10435003, //
        6.68067819, -6.56974315, 0.24291408, 4.80825202, //
        -3.96368681, 7.07684324, -8.69815195, -8.63785370, //
        21.26587242, 0.00000000, -8.69815195, 8.63785370, //
        -3.96368681, -7.07684324, 0.24291408, -4.80825202, //
        6.68067819, 6.56974315, -12.80832220, -8.10435003, //
        12.79582080, 16.86209207, -1.03221491, -14.13458480,
      ],
      [
        -2.71659207, 0.00000000, 6.51138523, -3.47373495, //
        -16.25705712, -2.93854624, 15.77272605, -0.97707947, //
        -4.67515311, 20.82604138, -1.35150666, -27.73808989, //
        -1.54006273, 23.77858730, 13.60856943, -17.36557299, //
        -21.42121009, 0.00000000, 13.60856943, 17.36557299, //
        -1.54006273, -23.77858730, -1.35150666, 27.73808989, //
        -4.67515311, -20.82604138, 15.77272605, 0.97707947, //
        -16.25705712, 2.93854624, 6.51138523, 3.47373495,
      ],
      [
        -6.81537738, 0.00000000, 7.88099791, 2.49025024, //
        -16.85555380, 9.47464543, 27.65123925, -14.09636627, //
        -20.66489896, -5.66712057, 0.40724319, 15.69704981, //
        2.58589822, -2.41077572, 3.31625696, -0.42156352, //
        -1.82698816, 0.00000000, 3.31625696, 0.42156352, //
        2.58589822, 2.41077572, 0.40724319, -15.69704981, //
        -20.66489896, 5.66712057, 27.65123925, 14.09636627, //
        -16.85555380, -9.47464543, 7.88099791, -2.49025024,
      ],
      [
        -11.30307174, 0.00000000, 1.24358571, -12.38205482, //
        9.67905065, 29.14724144, -3.31147797, -21.72940786, //
        -2.95202931, 5.06593288, 3.16005058, -6.83843986, //
        -1.99226115, 4.93196081, -0.46548167, 1.44880777, //
        0.58019807, 0.00000000, -0.46548167, -1.44880777, //
        -1.99226115, -4.93196081, 3.16005058, 6.83843986, //
        -2.95202931, -5.06593288, -3.31147797, 21.72940786, //
        9.67905065, -29.14724144, 1.24358571, 12.38205482,
      ],
      [
        -10.68754613, 0.00000000, -0.16928338, 15.31080210, //
        21.39398235, -21.15728863, -21.25777750, 11.16919036, //
        8.45824743, -4.96198243, -11.02235492, 4.08045024, //
        12.12053953, -3.58090983, -4.32393809, 3.96111165, //
        0.28871530, 0.00000000, -4.32393809, -3.96111165, //
        12.12053953, 3.58090983, -11.02235492, -4.08045024, //
        8.45824743, 4.96198243, -21.25777750, -11.16919036, //
        21.39398235, 21.15728863, -0.16928338, -15.31080210,
      ],
      [
        -4.87026614, 0.00000000, 9.44244306, -2.98126694, //
        -10.89686911, -5.67614949, -3.54146603, 14.66522435, //
        6.95451396, -11.39543966, 3.20403175, 13.10517705, //
        0.27696900, -14.18223562, -4.43971883, 6.40011633, //
        2.87045854, 0.00000000, -4.43971883, -6.40011633, //
        0.27696900, 14.18223562, 3.20403175, -13.10517705, //
        6.95451396, 11.39543966, -3.54146603, -14.66522435, //
        -10.89686911, 5.67614949, 9.44244306, 2.98126694,
      ],
      [
        -0.29481955, 0.00000000, -3.88773057, 2.69791515, //
        5.97664320, -2.46086612, -6.16800006, 4.30166835, //
        4.89975413, 4.51193948, 4.52899693, -14.00164338, //
        -2.45409209, 10.64073637, -10.79496709, -6.32879801, //
        16.09361065, 0.00000000, -10.79496709, 6.32879801, //
        -2.45409209, -10.64073637, 4.52899693, 14.00164338, //
        4.89975413, -4.51193948, -6.16800006, -4.30166835, //
        5.97664320, 2.46086612, -3.88773057, -2.69791515,
      ],
      ],
    );
  });
}

