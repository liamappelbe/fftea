// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';
import 'package:fftea/fftea.dart';
import 'package:test/test.dart';
import 'util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        -9.92318852, -6.70896400, 2.13663544, -9.57630901, //
        1.54276207, -1.51734686, 9.52082608, 4.71405296, //
        -8.88718437, -0.29847399, 4.52329416, 6.50984951, //
        -0.99289781, -3.93974783, 5.99155888, 4.39255392,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        -0.79385508, -0.80352651, 0.49612658, -3.80995544, //
        0.90727229, -1.16835708, 8.68440073, 4.66666681, //
        -8.79784947, -0.27225240, 3.48293651, 3.82833243, //
        -0.39502656, -0.91480913, 0.71760355, 0.35140431,
      ],
    );
    final b = [
        -1.99495673, -6.21409699, -9.80995425, -8.03263286, //
        -0.01508248, -7.64951589, 5.28404862, 5.32524614, //
        -2.51109789, -5.39457513, 6.53669178, -1.79893131, //
        6.03061527, 9.41720160, 1.46219354, -7.93963625, //
        6.35576218, 5.77561949, 6.85654763, 5.12358764, //
        -4.05681975, 8.28312203, -7.94258090, -8.58283600, //
        -5.02824291, 1.55619927, -0.67105911, -0.46414048, //
        -0.41460698, 1.92552595, -8.52044459, 7.68316581,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        -0.15959654, -0.49712776, -1.17492929, -0.96206112, //
        -0.00350215, -1.77621699, 2.10227028, 2.11866080, //
        -1.47673421, -3.17245843, 5.03325267, -1.38517711, //
        5.50081256, 8.58987989, 1.44749541, -7.85982620, //
        6.29187340, 5.71756237, 6.25418496, 4.67346928, //
        -3.12375121, 6.37800397, -4.67089754, -5.04742074, //
        -2.00049741, 0.61913728, -0.15581987, -0.10777338, //
        -0.04965710, 0.23061849, -0.68163557, 0.61465326,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        1.74828621, 5.95890396, -2.74961117, -3.30137771, //
        -9.67893965, 5.03125045, -8.37051857, 6.75675671, //
        -2.19862648, 9.04909710, -9.75634070, -8.34487540, //
        2.94711769, 6.94889543, -6.71132665, -0.43149541, //
        -3.73679335, -2.07354391, 9.09552652, 8.83873206, //
        -1.09934734, -0.45390519, 7.54720977, -9.60908186, //
        6.08365845, -1.12031760, -4.48852041, -4.84115610, //
        9.39266386, 3.57943487, 1.91340832, -7.90937681, //
        -2.79608988, 4.32043949, -8.22430009, -1.91804243, //
        9.12105068, 3.10233545, -2.52338423, 6.32447956, //
        2.49803580, 4.46048868, -1.44794675, 8.89158166, //
        0.72832676, 1.99007201, 0.01597322, -0.13443508, //
        0.08710747, -1.32054994, 2.88871625, -7.75140756, //
        -8.87230903, -2.80594353, 7.74623291, -9.87147089, //
        3.18343357, -2.27485506, -8.70119837, -1.69240250, //
        -1.11290408, 9.77315121, -4.89527701, -8.08559708, //
        -7.61943907, 5.75184493, -7.14977567, 0.95027745, //
        4.66777209, 0.97193953, 8.05257295, -5.63457232, //
        -6.42620092, 6.79022264, 6.76451995, -9.73583304, //
        -0.05072848, 9.71406702, -0.53400499, -4.23752652, //
        4.80595462, -8.90811513, 9.37465782, 5.92658349, //
        0.02054536, -9.77909081, -3.23521048, 4.60203935, //
        -7.62742187, 9.64804918, -2.55281438, -5.86934828, //
        3.24858017, 1.27292788, -4.26374445, -0.86444826, //
        -3.90442467, 8.93854008, 4.27579964, 4.94118682, //
        4.40935310, -5.93724490, 3.18839204, -0.33923164, //
        3.71310518, 8.15180041, -1.10952069, -6.17780475, //
        6.63777628, -3.53571017, -0.22603129, 9.30827156, //
        4.59534079, -7.72258462, 1.25758282, -0.95086451, //
        2.77439856, -6.02286650, -9.21767830, -4.23395699, //
        0.36678276, -3.43065673, -0.80341290, -1.23103936, //
        -0.84977393, -7.62448597, -7.26001341, 2.57624682,
      ],
      [
      [
        -7.83583051, 0.00000000, -0.99960443, 1.50773691, //
        13.43204501, 6.21295005, -14.19734200, -2.58647853, //
        9.13172222, -12.43184173, -1.45533353, 9.54843681, //
        -9.12699661, 6.39131183, 25.35069535, -11.81149290, //
        -36.43454152, 0.00000000, 25.35069535, 11.81149290, //
        -9.12699661, -6.39131183, -1.45533353, -9.54843681, //
        9.13172222, 12.43184173, -14.19734200, 2.58647853, //
        13.43204501, -6.21295005, -0.99960443, -1.50773691,
      ],
      [
        2.23886986, 0.00000000, -0.25182204, 10.06560145, //
        -11.34019874, -7.98483855, 18.22619893, 9.84745962, //
        -1.91159280, -2.08075836, -7.95071006, -15.14349823, //
        1.45272490, 13.91879011, 4.76019076, -6.89574499, //
        -8.20845177, 0.00000000, 4.76019076, 6.89574499, //
        1.45272490, -13.91879011, -7.95071006, 15.14349823, //
        -1.91159280, 2.08075836, 18.22619893, -9.84745962, //
        -11.34019874, 7.98483855, -0.25182204, -10.06560145,
      ],
      [
        3.72747642, 0.00000000, 4.84127285, -5.50693028, //
        -4.56787399, 2.73963673, -6.85538706, -2.30309544, //
        3.60759037, -8.27274505, -2.53059244, 21.82729923, //
        11.32633767, -14.80216611, -19.52404207, 3.21460133, //
        23.67791291, 0.00000000, -19.52404207, -3.21460133, //
        11.32633767, 14.80216611, -2.53059244, -21.82729923, //
        3.60759037, 8.27274505, -6.85538706, 2.30309544, //
        -4.56787399, -2.73963673, 4.84127285, 5.50693028,
      ],
      [
        -3.21377434, 0.00000000, 7.80783213, -4.10513406, //
        -14.23613025, 4.46458951, 4.28231847, 8.37739352, //
        10.86210557, -17.61205795, -3.82246127, 14.58030538, //
        -7.97190383, -12.60020479, 2.79446765, 10.24172491, //
        3.78131741, 0.00000000, 2.79446765, -10.24172491, //
        -7.97190383, 12.60020479, -3.82246127, -14.58030538, //
        10.86210557, 17.61205795, 4.28231847, -8.37739352, //
        -14.23613025, -4.46458951, 7.80783213, 4.10513406,
      ],
      [
        20.41182733, 0.00000000, -13.28181375, -0.59488437, //
        -0.29171551, 0.47750214, -0.76286215, 3.00153145, //
        12.48787917, 3.62592292, -7.01905295, -10.18685427, //
        -5.34452246, 0.14787683, 11.18076178, 5.35912727, //
        -14.34917558, 0.00000000, 11.18076178, -5.35912727, //
        -5.34452246, -0.14787683, -7.01905295, 10.18685427, //
        12.48787917, -3.62592292, -0.76286215, -3.00153145, //
        -0.29171551, -0.47750214, -13.28181375, 0.59488437,
      ],
      [
        -1.61573561, 0.00000000, 1.90853062, -10.62052209, //
        2.07458761, 0.61848902, -3.01488032, 7.79923690, //
        -4.85321582, -1.36854514, 5.79216190, -2.99165825, //
        3.42388094, 3.77388929, -5.03043507, -7.54127245, //
        1.01447588, 0.00000000, -5.03043507, 7.54127245, //
        3.42388094, -3.77388929, 5.79216190, 2.99165825, //
        -4.85321582, 1.36854514, -3.01488032, -7.79923690, //
        2.07458761, -0.61848902, 1.90853062, 10.62052209,
      ],
      [
        -17.36744883, 0.00000000, 8.32534631, 2.47842661, //
        2.93314294, 9.64408795, -0.32246135, -9.49088242, //
        -2.88262623, -10.77396319, -5.67170306, 19.65269189, //
        13.93287421, -16.04176986, -14.92578486, 13.56056081, //
        14.58987293, 0.00000000, -14.92578486, -13.56056081, //
        13.93287421, 16.04176986, -5.67170306, -19.65269189, //
        -2.88262623, 10.77396319, -0.32246135, 9.49088242, //
        2.93314294, -9.64408795, 8.32534631, -2.47842661,
      ],
      [
        -12.88191573, 0.00000000, 13.01014195, 2.32119003, //
        -15.83423605, -1.20302909, 10.06548838, 12.98071950, //
        4.34341168, -20.65207143, -7.29502052, 16.22889764, //
        -1.23425602, -6.64719503, 14.36414042, -3.33980267, //
        -21.95742395, 0.00000000, 14.36414042, 3.33980267, //
        -1.23425602, 6.64719503, -7.29502052, -16.22889764, //
        4.34341168, 20.65207143, 10.06548838, -12.98071950, //
        -15.83423605, 1.20302909, 13.01014195, -2.32119003,
      ],
      [
        5.46043800, 0.00000000, -1.01097646, -3.40980597, //
        -6.42029939, 0.13211161, 9.74185118, 14.29313663, //
        -14.94677573, -19.34789645, 22.15098133, 10.58801886, //
        -11.41230917, -6.60782457, -5.45790818, 3.26655556, //
        9.25043482, 0.00000000, -5.45790818, -3.26655556, //
        -11.41230917, 6.60782457, 22.15098133, -10.58801886, //
        -14.94677573, 19.34789645, 9.74185118, -14.29313663, //
        -6.42029939, -0.13211161, -1.01097646, 3.40980597,
      ],
      [
        5.88171716, 0.00000000, -3.05056028, 0.77211994, //
        -7.62285515, -2.17487575, 18.34107483, 1.41218394, //
        -2.79469178, -2.18564028, -19.97256867, -7.36359305, //
        17.17157731, 15.37100634, -14.33172108, -8.14411214, //
        18.63777249, 0.00000000, -14.33172108, 8.14411214, //
        17.17157731, -15.37100634, -19.97256867, 7.36359305, //
        -2.79469178, 2.18564028, 18.34107483, -1.41218394, //
        -7.62285515, 2.17487575, -3.05056028, -0.77211994,
      ],
      [
        -5.30883538, 0.00000000, 4.22126064, 4.42862000, //
        6.32065835, -9.61980281, -13.93107959, 1.72702435, //
        -2.93607732, 2.13997237, 20.24055791, 4.97228396, //
        -23.67623126, -4.12606622, 19.64559359, 3.22983809, //
        -14.46052929, 0.00000000, 19.64559359, -3.22983809, //
        -23.67623126, 4.12606622, 20.24055791, -4.97228396, //
        -2.93607732, -2.13997237, -13.93107959, -1.72702435, //
        6.32065835, 9.61980281, 4.22126064, -4.42862000,
      ],
      [
        6.84200412, 0.00000000, -4.73580883, 10.98668670, //
        -2.24819483, -13.63489550, 7.18035917, 12.45647145, //
        0.38994645, -8.62848623, 0.02663502, 1.13372250, //
        -12.11027079, -0.62830898, 12.97587124, 0.74666018, //
        -9.79907898, 0.00000000, 12.97587124, -0.74666018, //
        -12.11027079, 0.62830898, 0.02663502, -1.13372250, //
        0.38994645, 8.62848623, 7.18035917, -12.45647145, //
        -2.24819483, 13.63489550, -4.73580883, -10.98668670,
      ],
      [
        11.83207139, 0.00000000, -7.33609373, -1.63007270, //
        8.96151084, -5.08224281, -13.56321402, 4.25090416, //
        5.65157627, -4.76206628, 8.13326101, 10.23673676, //
        -11.07328734, -11.08010657, -1.92409345, 4.92309069, //
        10.46860947, 0.00000000, -1.92409345, -4.92309069, //
        -11.07328734, 11.08010657, 8.13326101, -10.23673676, //
        5.65157627, 4.76206628, -13.56321402, -4.25090416, //
        8.96151084, 5.08224281, -7.33609373, 1.63007270,
      ],
      [
        5.59232329, 0.00000000, -7.18815532, -5.36274733, //
        6.20095220, 9.13846947, -4.36910203, -13.16725479, //
        9.01273713, 16.82799707, -2.85334032, -19.90088828, //
        -6.35936494, 11.86354186, -3.76992703, -1.26727967, //
        13.06007734, 0.00000000, -3.76992703, 1.26727967, //
        -6.35936494, -11.86354186, -2.85334032, 19.90088828, //
        9.01273713, -16.82799707, -4.36910203, 13.16725479, //
        6.20095220, -9.13846947, -7.18815532, 5.36274733,
      ],
      [
        -21.85588349, 0.00000000, 13.69173500, 6.50077825, //
        -1.46818049, -12.16068210, -7.27979061, 7.12517762, //
        10.64719739, 4.01931828, -5.93926932, -6.72716914, //
        -0.28349190, 4.35289205, -1.92377594, -0.04840546, //
        6.96703525, 0.00000000, -1.92377594, 0.04840546, //
        -0.28349190, -4.35289205, -5.93926932, 6.72716914, //
        10.64719739, -4.01931828, -7.27979061, -7.12517762, //
        -1.46818049, 12.16068210, 13.69173500, -6.50077825,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        -9.97505988, -6.65041413, -6.44975293, -4.77970677, //
        -1.76546505, 3.69824889, -0.16066038, 9.28194530, //
        -4.50630162, -7.63357601, 6.95327033, 1.74470382, //
        5.52654435, 4.35150738, 9.92696919, -3.35583683, //
        -3.44564861, -3.98933902, 5.21473908, -1.23728237, //
        1.46432929, 1.23862839, 0.64522971, 6.85662802, //
        6.77583288, 6.53876673, -0.90668203, 7.15794637, //
        -9.93524038, 7.96161224, 2.71890298, -7.75876406, //
        -8.54803450, -9.84072698, -3.79869240, -4.39300223, //
        -1.56839159, -4.71716601, -1.85432842, -7.89990839, //
        4.47378915, 7.20227407, -4.41114021, 4.59110324, //
        0.10828073, 9.42488546, -0.24849487,
      ],
      [
      [
        5.70322470, 0.00000000, -3.73364498, 2.20545125, //
        -5.96939030, 10.66975133, 11.82523790, -12.84604676, //
        -7.95443089, 12.19125500, 5.16055986, -16.77370620, //
        -4.81348126, 18.39803675, 4.57610667, -13.25971743, //
        -3.88513871, 0.00000000, 4.57610667, 13.25971743, //
        -4.81348126, -18.39803675, 5.16055986, 16.77370620, //
        -7.95443089, -12.19125500, 11.82523790, 12.84604676, //
        -5.96939030, -10.66975133, -3.73364498, -2.20545125,
      ],
      [
        16.30931892, 0.00000000, -17.47731225, -4.17540361, //
        18.25627300, 6.77086990, -7.84507508, -1.80684104, //
        -1.83336506, -13.04337177, -4.18644721, 11.90650969, //
        1.53971833, 1.75899608, 12.29298679, -1.81192591, //
        -17.80287594, 0.00000000, 12.29298679, 1.81192591, //
        1.53971833, -1.75899608, -4.18644721, -11.90650969, //
        -1.83336506, 13.04337177, -7.84507508, 1.80684104, //
        18.25627300, -6.77086990, -17.47731225, 4.17540361,
      ],
      [
        5.86724587, 0.00000000, 3.58287876, 0.95070864, //
        -4.64470782, -9.41267693, -9.60172414, 9.25844299, //
        11.67418171, 0.66797535, -5.27542228, -6.34228806, //
        3.54976864, 0.25981674, -9.33677954, 6.38753212, //
        14.23636348, 0.00000000, -9.33677954, -6.38753212, //
        3.54976864, -0.25981674, -5.27542228, 6.34228806, //
        11.67418171, -0.66797535, -9.60172414, -9.25844299, //
        -4.64470782, 9.41267693, 3.58287876, -0.95070864,
      ],
      [
        21.65358832, 0.00000000, -17.82261058, 4.03972658, //
        9.13742090, -7.86226007, -4.53904406, 7.36984284, //
        2.86280534, -3.49536612, -0.05792299, 6.91142059, //
        0.84659566, -2.30307750, -4.70726688, -9.04396145, //
        6.90645691, 0.00000000, -4.70726688, 9.04396145, //
        0.84659566, 2.30307750, -0.05792299, -6.91142059, //
        2.86280534, 3.49536612, -4.53904406, -7.36984284, //
        9.13742090, 7.86226007, -17.82261058, -4.03972658,
      ],
      [
        7.81842468, 0.00000000, -4.17391632, -17.02120404, //
        -1.44108505, 0.41725985, 5.17223520, 13.63444586, //
        -10.19952102, -5.36720974, 16.28643601, -3.41665004, //
        -19.78984057, 6.67771848, 22.02198896, -7.29100624, //
        -23.57101908, 0.00000000, 22.02198896, 7.29100624, //
        -19.78984057, -6.67771848, 16.28643601, 3.41665004, //
        -10.19952102, 5.36720974, 5.17223520, -13.63444586, //
        -1.44108505, -0.41725985, -4.17391632, 17.02120404,
      ],
      [
        -30.93205147, 0.00000000, 26.69058943, -2.33360587, //
        -19.12135775, -4.50517242, 10.91894192, 12.16900655, //
        2.50390614, -11.01060871, -7.22850927, -2.99196900, //
        -5.87939850, 5.99238861, 8.55179885, 6.61203634, //
        -1.93989017, 0.00000000, 8.55179885, -6.61203634, //
        -5.87939850, -5.99238861, -7.22850927, 2.99196900, //
        2.50390614, 11.01060871, 10.91894192, -12.16900655, //
        -19.12135775, 4.50517242, 26.69058943, 2.33360587,
      ],
      [
        -19.03280640, 0.00000000, 8.79846938, 14.69369783, //
        -5.41688290, -3.56557504, 11.66196592, -2.55091728, //
        -5.98321857, 5.92819386, -3.26161867, -10.16110049, //
        8.99253439, 3.14471138, -9.86254602, 4.78803272, //
        9.17539934, 0.00000000, -9.86254602, -4.78803272, //
        8.99253439, -3.14471138, -3.26161867, 10.16110049, //
        -5.98321857, -5.92819386, 11.66196592, 2.55091728, //
        -5.41688290, 3.56557504, 8.79846938, -14.69369783,
      ],
      [
        11.22555502, 0.00000000, -12.29648655, 4.40471026, //
        4.01749073, 0.04249145, 10.78686621, 1.85615690, //
        -12.62469617, -8.52631816, 0.44440252, 8.69452167, //
        13.79006280, -0.40998242, -17.09854191, -6.20827232, //
        14.73624969, 0.00000000, -17.09854191, 6.20827232, //
        13.79006280, 0.40998242, 0.44440252, -8.69452167, //
        -12.62469617, 8.52631816, 10.78686621, -1.85615690, //
        4.01749073, -0.04249145, -12.29648655, -4.40471026,
      ],
      ],
    );
  });
}

