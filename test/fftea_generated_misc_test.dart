// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';
import 'package:fftea/fftea.dart';
import 'package:test/test.dart';
import 'util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        8.91135995, 9.50639798, 0.58014681, -1.84326125, //
        4.99776747, 3.98048601, 6.63958830, -6.49132915, //
        -7.19928482, 5.18325287, -3.87169722, 4.51818576, //
        7.31761227, -0.89153149, -2.78740941, 4.70646773,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        0.71290880, 1.13857263, 0.13471004, -0.73334551, //
        2.93910255, 3.06497423, 6.05628597, -6.42607764, //
        -7.12691687, 4.72789279, -2.98120686, 2.65706866, //
        2.91132801, -0.20701354, -0.33384549, 0.37651742,
      ],
    );
    final b = [
        7.23464922, 5.31511075, -3.52809000, 7.72174294, //
        3.85448506, -0.33343953, -4.52372786, 0.59641322, //
        7.93307478, -1.01417460, -4.94715590, 3.33949274, //
        8.99328357, 5.24893145, -5.32396727, 2.31829751, //
        7.19875372, -7.70907182, 2.96245100, -5.43325930, //
        6.97843201, -9.90980880, -2.87368697, -9.85362037, //
        2.23690372, 7.30427379, -0.86005539, -0.18389155, //
        2.65377110, 9.44517842, 5.05609963, -7.35302131,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        0.57877194, 0.42520886, -0.42255613, 0.92482612, //
        0.89501113, -0.07742463, -1.79977500, 0.23728430, //
        4.66530716, -0.59641894, -3.80931004, 2.57140941, //
        8.20320398, 4.78780137, -5.27045019, 2.29499374, //
        7.12639110, -7.63157943, 2.70219321, -4.95593561, //
        5.37339264, -7.63055277, -1.68996672, -5.79474754, //
        0.88995703, 2.90602127, -0.19970479, -0.04269960, //
        0.31783975, 1.13124042, 0.40448797, -0.58824170,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        -3.15555559, 1.21854354, 2.50138806, 9.26664159, //
        -9.75936590, 7.70429528, -4.93554221, -4.75270288, //
        -7.07541303, -4.63470789, -7.46736415, 8.08106627, //
        2.53833890, 0.67527881, 8.94886962, -1.47027165, //
        5.23528293, -6.08858800, 2.81227846, -7.56844123, //
        8.41408143, 3.44055385, -5.95145620, -4.68634905, //
        -3.38947632, 5.46151801, 2.75158764, 7.69548115, //
        2.09109589, -1.54790557, 6.66872558, -3.09084099, //
        1.33456591, 6.70511846, -8.58080237, -1.33286494, //
        9.18686791, -1.14223351, -7.66506041, -9.64941637, //
        8.95746275, -0.12793987, 6.42496001, -1.57864104, //
        -3.78178145, -0.91547283, -4.23063147, 2.46976405, //
        6.43127334, -2.24221603, -1.57975595, 8.57071092, //
        -0.98961039, 6.74732151, 3.54209249, -9.17335162, //
        -7.99757032, 6.28886475, -4.71295927, -2.13397497, //
        8.15854905, 1.57965356, 3.96012111, 1.25129047, //
        0.74491443, 8.00842260, 1.81786990, 2.86293987, //
        4.09665825, -1.97846330, -4.12956209, -9.19877080, //
        -0.27229297, -6.22965647, 8.44935767, -8.83522467, //
        5.25556170, -5.27634124, -9.41724460, -1.98642898, //
        -9.48316240, 5.59508842, -3.20500818, 6.57142595, //
        5.79877567, -8.92657029, -4.88056690, 8.46116415, //
        2.53793371, -9.27333844, -8.83983280, -2.75951078, //
        -6.35088118, 5.24054188, 0.98942316, -1.40234788, //
        -8.76957854, 7.71261009, -5.33253624, -7.73633309, //
        2.36775203, -5.06648838, 7.04793966, 0.28644068, //
        1.05046161, 8.15421765, -7.14452191, 7.29631084, //
        0.00406970, 7.44658027, -3.76894165, 2.02047851, //
        -3.95096670, -4.52887598, 8.41790991, 4.31248822, //
        -4.86471345, -2.12716963, -9.33776977, -1.11515068, //
        -8.83948357, -8.42620210, -4.08429389, 6.16300649, //
        3.46634111, -3.34306328, 2.95581905, -7.24392058,
      ],
      [
      [
        -16.06085770, 0.00000000, 20.29458161, 1.54881660, //
        -18.32070359, -0.54236452, 9.13891698, -4.98223170, //
        -2.24676846, 1.21317824, -10.50872231, 9.19631907, //
        13.35004068, -2.76096869, 9.06764633, -9.33952556, //
        -25.48912476, 0.00000000, 9.06764633, 9.33952556, //
        13.35004068, 2.76096869, -10.50872231, -9.19631907, //
        -2.24676846, -1.21317824, 9.13891698, 4.98223170, //
        -18.32070359, 0.54236452, 20.29458161, -1.54881660,
      ],
      [
        10.72389364, 0.00000000, -4.51016422, -9.89275264, //
        -3.97410169, 11.71271328, -0.81928767, -5.96106679, //
        0.77599747, 1.78983244, 7.00399878, 4.13025397, //
        5.71260921, -2.21371808, -22.38687161, -5.82207131, //
        25.67174581, 0.00000000, -22.38687161, 5.82207131, //
        5.71260921, 2.21371808, 7.00399878, -4.13025397, //
        0.77599747, -1.78983244, -0.81928767, 5.96106679, //
        -3.97410169, -11.71271328, -4.51016422, 9.89275264,
      ],
      [
        3.45197342, 0.00000000, 1.99515671, 8.70283295, //
        -11.49199274, -13.72098792, 9.21783721, 16.61277874, //
        4.58274257, -10.00117273, -8.27300388, -1.51703064, //
        -5.95139588, 1.52663419, 10.46977888, 6.27038498, //
        -4.55021917, 0.00000000, 10.46977888, -6.27038498, //
        -5.95139588, -1.52663419, -8.27300388, 1.51703064, //
        4.58274257, 10.00117273, 9.21783721, -16.61277874, //
        -11.49199274, 13.72098792, 1.99515671, -8.70283295,
      ],
      [
        9.18558083, 0.00000000, -1.83655300, -6.19086243, //
        -1.12007257, 2.74984884, -6.78807503, -2.25457618, //
        5.92862084, -6.08546905, 3.40203656, 20.52780183, //
        -4.89760362, -20.61209718, -0.05734522, 8.51492624, //
        1.55240325, 0.00000000, -0.05734522, -8.51492624, //
        -4.89760362, 20.61209718, 3.40203656, -20.52780183, //
        5.92862084, 6.08546905, -6.78807503, 2.25457618, //
        -1.12007257, -2.74984884, -1.83655300, 6.19086243,
      ],
      [
        -2.80054667, 0.00000000, 1.12188760, 6.57275674, //
        0.12203807, -17.15764723, -6.44563206, 23.89475016, //
        16.34343028, -10.04230058, -11.99755969, -7.23408921, //
        10.06313500, 3.87264975, -18.11706276, 0.96452498, //
        20.62007380, 0.00000000, -18.11706276, -0.96452498, //
        10.06313500, -3.87264975, -11.99755969, 7.23408921, //
        16.34343028, 10.04230058, -6.44563206, -23.89475016, //
        0.12203807, 17.15764723, 1.12188760, -6.57275674,
      ],
      [
        5.16179804, 0.00000000, -3.67587995, 7.80505277, //
        5.81567347, -3.04380616, -7.71403249, -7.35735032, //
        7.72599212, 8.23466641, -13.81496971, -6.31352769, //
        11.76722368, 4.05943678, -0.23913371, 1.86231281, //
        -4.89154487, 0.00000000, -0.23913371, -1.86231281, //
        11.76722368, -4.05943678, -13.81496971, 6.31352769, //
        7.72599212, -8.23466641, -7.71403249, 7.35735032, //
        5.81567347, 3.04380616, -3.67587995, -7.80505277,
      ],
      [
        -2.43633687, 0.00000000, 10.86558975, -3.66611583, //
        -17.66789128, -0.69566948, 9.60752596, 9.32379759, //
        -5.21697641, -18.20375936, 5.87243963, 24.97235722, //
        -2.69684916, -15.03787724, 5.29519374, -1.47849938, //
        -9.68172760, 0.00000000, 5.29519374, 1.47849938, //
        -2.69684916, 15.03787724, 5.87243963, -24.97235722, //
        -5.21697641, 18.20375936, 9.60752596, -9.32379759, //
        -17.66789128, 0.69566948, 10.86558975, 3.66611583,
      ],
      [
        21.09939784, 0.00000000, -13.96160802, -1.29464192, //
        -0.19781901, -1.60980051, 3.83489447, 6.93581088, //
        2.67064185, -6.29152275, 3.04045272, 3.04250812, //
        -10.17070118, -7.24927661, 4.13915946, 7.17331214, //
        0.19056157, 0.00000000, 4.13915946, -7.17331214, //
        -10.17070118, 7.24927661, 3.04045272, -3.04250812, //
        2.67064185, 6.29152275, 3.83489447, -6.93581088, //
        -0.19781901, 1.60980051, -13.96160802, 1.29464192,
      ],
      [
        -14.32952959, 0.00000000, 14.76534183, 2.51056485, //
        -10.10326032, -12.38954281, 1.96859058, 11.96031949, //
        1.31342067, -5.34318802, 2.39992958, -2.17634452, //
        1.40824517, 9.17058279, -18.05659061, -9.83935551, //
        26.93817580, 0.00000000, -18.05659061, 9.83935551, //
        1.40824517, -9.17058279, 2.39992958, 2.17634452, //
        1.31342067, 5.34318802, 1.96859058, -11.96031949, //
        -10.10326032, 12.38954281, 14.76534183, -2.51056485,
      ],
      [
        -16.23911439, 0.00000000, 13.22468994, 13.54311987, //
        -8.85192571, -16.75059326, 3.41099087, 7.31818464, //
        5.26122955, -0.74554999, -1.77601006, -0.85151919, //
        -19.71894217, -1.30456899, 22.65851916, 8.96954013, //
        -12.17798875, 0.00000000, 22.65851916, -8.96954013, //
        -19.71894217, 1.30456899, -1.77601006, 0.85151919, //
        5.26122955, 0.74554999, 3.41099087, -7.31818464, //
        -8.85192571, 16.75059326, 13.22468994, -13.54311987,
      ],
      [
        -12.87215845, 0.00000000, 9.54162069, -9.58220843, //
        5.25265075, 9.81721471, -20.36702616, -12.91094063, //
        15.05032297, 23.08902178, 0.41685189, -21.38154139, //
        -2.24880510, 4.24051473, 0.36773862, 3.53371831, //
        -3.15454891, 0.00000000, 0.36773862, -3.53371831, //
        -2.24880510, -4.24051473, 0.41685189, 21.38154139, //
        15.05032297, -23.08902178, -20.36702616, 12.91094063, //
        5.25265075, -9.81721471, 9.54162069, 9.58220843,
      ],
      [
        -12.57071850, 0.00000000, 3.96160571, -2.00412032, //
        -0.80707683, 6.91303560, 6.34410497, 4.65519991, //
        -7.10087430, -16.28040681, 8.25035399, 17.72862675, //
        -11.16179132, -6.40980860, 16.13897684, -6.23230437, //
        -18.67987963, 0.00000000, 16.13897684, 6.23230437, //
        -11.16179132, 6.40980860, 8.25035399, -17.72862675, //
        -7.10087430, 16.28040681, 6.34410497, -4.65519991, //
        -0.80707683, -6.91303560, 3.96160571, 2.00412032,
      ],
      [
        9.10041298, 0.00000000, -9.90392624, 4.33308621, //
        6.23784911, 4.42674584, -0.84114662, -4.72797529, //
        2.37659256, -3.50104557, 1.67877416, 8.23580235, //
        -6.77794260, -20.47841055, 4.91036247, 22.52173869, //
        -4.46153867, 0.00000000, 4.91036247, -22.52173869, //
        -6.77794260, 20.47841055, 1.67877416, -8.23580235, //
        2.37659256, 3.50104557, -0.84114662, 4.72797529, //
        6.23784911, -4.42674584, -9.90392624, -4.33308621,
      ],
      [
        4.12248137, 0.00000000, 0.77818198, -2.33857963, //
        -10.63045931, -4.64997384, 13.37680383, 5.47680653, //
        -6.90506183, 5.41174344, 0.78859736, -12.73946511, //
        6.17180325, 13.23835949, 0.68760741, -13.82299244, //
        -12.65742676, 0.00000000, 0.68760741, 13.82299244, //
        6.17180325, -13.23835949, 0.78859736, 12.73946511, //
        -6.90506183, -5.41174344, 13.37680383, -5.47680653, //
        -10.63045931, 4.64997384, 0.77818198, 2.33857963,
      ],
      [
        -26.39605207, 0.00000000, 25.50238751, 7.10742779, //
        -15.50257549, -6.87935938, 3.59836392, -7.94506090, //
        -0.24299129, 13.75634798, -4.53933758, -6.00043652, //
        0.99480395, 6.41606877, 10.41019257, -6.48474238, //
        -14.04563512, 0.00000000, 10.41019257, 6.48474238, //
        0.99480395, -6.41606877, -4.53933758, 6.00043652, //
        -0.24299129, -13.75634798, 3.59836392, 7.94506090, //
        -15.50257549, 6.87935938, 25.50238751, -7.10742779,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        -5.13739055, 0.80321378, 0.74351000, 5.31259147, //
        0.89722387, 1.32226402, 6.64721607, 2.13706231, //
        -4.52817640, -6.44881243, 4.91918687, 8.35474105, //
        4.56029301, -2.66470891, -3.79439572, 0.79479870, //
        0.55527755, -5.73442735, -0.34526094, 3.76603471, //
        -3.65508473, -9.89645523, 8.06826618, 6.03337554, //
        -1.28293483, 8.15531952, 6.96446708, 5.22568056, //
        -7.09752820, 4.70411823, -1.82407659, 0.80557318, //
        6.86914332, -5.61136885, 8.69208974, -1.01540666, //
        8.51045887, 8.84022014, 6.91964718, -8.01398596, //
        -8.40116447, 3.26592928, -0.40262168, 6.11975424, //
        1.80706248, -6.41269305, 2.99556852,
      ],
      [
      [
        10.56895104, 0.00000000, -0.55381316, -2.57636860, //
        -14.10512371, 3.45972426, 16.69510254, -10.81464871, //
        -12.06848805, 13.81061440, 6.04080129, -4.96333848, //
        1.00562817, -0.61237483, -4.26728812, -1.04520971, //
        3.93741104, 0.00000000, -4.26728812, 1.04520971, //
        1.00562817, 0.61237483, 6.04080129, 4.96333848, //
        -12.06848805, -13.81061440, 16.69510254, 10.81464871, //
        -14.10512371, -3.45972426, -0.55381316, 2.57636860,
      ],
      [
        4.23136447, 0.00000000, -5.64497829, -8.35876162, //
        2.19376279, 15.64091566, 12.92282447, -13.52290983, //
        -16.84761109, 2.76512994, 3.14827877, -0.24853756, //
        3.62033842, 2.10074286, 0.11625011, -1.40539943, //
        -3.24909482, 0.00000000, 0.11625011, 1.40539943, //
        3.62033842, -2.10074286, 3.14827877, 0.24853756, //
        -16.84761109, -2.76512994, 12.92282447, 13.52290983, //
        2.19376279, -15.64091566, -5.64497829, 8.35876162,
      ],
      [
        -7.88564020, 0.00000000, 6.73865368, 1.52522158, //
        1.00838356, 1.40199986, -5.30118893, 1.88961144, //
        1.89060719, -17.41965612, 1.82915961, 17.38811575, //
        -3.07537739, -3.46535683, -1.90067017, -2.50837990, //
        5.50650510, 0.00000000, -1.90067017, 2.50837990, //
        -3.07537739, 3.46535683, 1.82915961, -17.38811575, //
        1.89060719, 17.41965612, -5.30118893, -1.88961144, //
        1.00838356, -1.40199986, 6.73865368, -1.52522158,
      ],
      [
        12.92760165, 0.00000000, -11.68608531, 12.79919124, //
        7.05472236, -12.87355144, -7.82981759, 1.15946286, //
        13.43299344, 16.75896533, -7.06024620, -22.32782801, //
        -2.89036400, 14.95824465, 2.70633439, -9.59042747, //
        -0.38267583, 0.00000000, 2.70633439, 9.59042747, //
        -2.89036400, -14.95824465, -7.06024620, 22.32782801, //
        13.43299344, -16.75896533, -7.82981759, -1.15946286, //
        7.05472236, 12.87355144, -11.68608531, -12.79919124,
      ],
      [
        17.99984679, 0.00000000, -6.42740576, -11.22738656, //
        -7.78089656, 9.53705991, 10.52130718, -6.30712846, //
        -11.99713626, -1.31733973, 8.07362905, 12.05610248, //
        -9.58848509, -3.87982258, 15.91238630, -5.19115429, //
        -15.42664452, 0.00000000, 15.91238630, 5.19115429, //
        -9.58848509, 3.87982258, 8.07362905, -12.05610248, //
        -11.99713626, 1.31733973, 10.52130718, 6.30712846, //
        -7.78089656, -9.53705991, -6.42740576, 11.22738656,
      ],
      [
        17.56905045, 0.00000000, -9.09812015, 7.76906677, //
        -2.05744119, -2.43618031, 3.95318739, -5.35637131, //
        -0.38309966, 1.10215981, 6.36770617, -0.62378100, //
        -20.34694899, -2.99472262, 20.97745823, 10.67643826, //
        -16.39453407, 0.00000000, 20.97745823, -10.67643826, //
        -20.34694899, 2.99472262, 6.36770617, 0.62378100, //
        -0.38309966, -1.10215981, 3.95318739, 5.35637131, //
        -2.05744119, 2.43618031, -9.09812015, -7.76906677,
      ],
      [
        15.76226248, 0.00000000, -9.07522368, -16.62322037, //
        3.18258794, 24.49691490, -5.45528843, -22.62560516, //
        8.89385159, 15.57163677, -7.97484249, -11.21074736, //
        1.18303973, -1.38383600, -4.87081232, 14.54936795, //
        12.47111284, 0.00000000, -4.87081232, -14.54936795, //
        1.18303973, 1.38383600, -7.97484249, 11.21074736, //
        8.89385159, -15.57163677, -5.45528843, 22.62560516, //
        3.18258794, -24.49691490, -9.07522368, 16.62322037,
      ],
      [
        0.58238695, 0.00000000, -1.81602350, 3.68009993, //
        13.20816805, -2.71204070, -15.23287804, -11.54099076, //
        2.02003064, 7.94528816, -1.56517224, 10.35830361, //
        7.74928471, -15.31424356, -5.59748054, 7.87604310, //
        1.88575489, 0.00000000, -5.59748054, -7.87604310, //
        7.74928471, 15.31424356, -1.56517224, -10.35830361, //
        2.02003064, -7.94528816, -15.23287804, 11.54099076, //
        13.20816805, 2.71204070, -1.81602350, -3.68009993,
      ],
      ],
    );
  });
}

