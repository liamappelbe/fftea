// Copyright 2022 The fftea authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// GENERATED FILE. DO NOT EDIT.

// Test cases generated with numpy as a reference implementation, using:
//   python3 test/generate_test.py

import 'dart:typed_data';
import 'package:fftea/fftea.dart';
import 'package:test/test.dart';
import 'util.dart';

void main() {
  test('Window hamming 16', () {
    expectClose(
      Window.hamming(16),
      [
        0.08000000, 0.11976909, 0.23219992, 0.39785218, //
        0.58808309, 0.77000000, 0.91214782, 0.98994790, //
        0.98994790, 0.91214782, 0.77000000, 0.58808309, //
        0.39785218, 0.23219992, 0.11976909, 0.08000000,
      ],
    );
  });

  test('Window hanning 16', () {
    expectClose(
      Window.hanning(16),
      [
        0.00000000, 0.04322727, 0.16543470, 0.34549150, //
        0.55226423, 0.75000000, 0.90450850, 0.98907380, //
        0.98907380, 0.90450850, 0.75000000, 0.55226423, //
        0.34549150, 0.16543470, 0.04322727, 0.00000000,
      ],
    );
  });

  test('Window bartlett 16', () {
    expectClose(
      Window.bartlett(16),
      [
        0.00000000, 0.13333333, 0.26666667, 0.40000000, //
        0.53333333, 0.66666667, 0.80000000, 0.93333333, //
        0.93333333, 0.80000000, 0.66666667, 0.53333333, //
        0.40000000, 0.26666667, 0.13333333, 0.00000000,
      ],
    );
  });

  test('Window blackman 16', () {
    expectClose(
      Window.blackman(16),
      [
        -0.00000000, 0.01675772, 0.07707242, 0.20077014, //
        0.39401242, 0.63000000, 0.84922986, 0.98215744, //
        0.98215744, 0.84922986, 0.63000000, 0.39401242, //
        0.20077014, 0.07707242, 0.01675772, -0.00000000,
      ],
    );
  });

  test('Window apply 16', () {
    final w = Window.hamming(16);
    final a = [
        -0.47774877, -8.57543843, 7.42057561, -5.51393004, //
        1.93521396, 6.89123785, 9.72966307, -6.26377945, //
        9.34514846, -7.33110325, -3.18140810, -8.28254981, //
        7.62927780, -1.38422401, 6.19115868, 6.79291804,
      ];
    expectClose(
      w.applyWindowReal(Float64List.fromList(a)),
      [
        -0.03821990, -1.02707245, 1.72305707, -2.19372910, //
        1.13806661, 5.30625314, 8.87489093, -6.20081529, //
        9.25121006, -6.68704983, -2.44968424, -4.87082751, //
        3.03532482, -0.32141671, 0.74150944, 0.54343344,
      ],
    );
    final b = [
        -7.20683807, -0.59981593, 1.22735769, -7.80037961, //
        6.94125793, -4.65233517, 7.37589595, 7.19384201, //
        -2.63350950, -7.14070083, -6.38257823, -1.32123562, //
        -3.80126642, -6.08832946, -1.77059843, 8.72546967, //
        1.35282651, -1.95643620, -1.63560519, -7.18391363, //
        -9.61533700, -0.39986019, -9.31062546, -8.84852590, //
        4.64724162, -5.43485926, -2.77285419, -6.15498825, //
        7.34822497, -8.42203868, -4.32838158, -9.84733608,
      ];
    expectClose(
      toFloats(w.applyWindow(makeArray(b))),
      [
        -0.57654705, -0.04798527, 0.14699951, -0.93424436, //
        1.61175954, -1.08027186, 2.93451630, 2.86208574, //
        -1.54872241, -4.19932543, -4.91458523, -1.01735143, //
        -3.46731687, -5.55345643, -1.75280019, 8.63776034, //
        1.33922776, -1.93676990, -1.49191370, -6.55279114, //
        -7.40380949, -0.30789234, -5.47542142, -5.20366848, //
        1.84891522, -2.16227062, -0.64385653, -1.42918779, //
        0.88009021, -1.00869990, -0.34627053, -0.78778689,
      ],
    );
  });

  test('STFT 128 128 16 8', () {
    testStft(
      16,
      8,
      [
        -1.45615364, -5.53050313, 7.23275110, 5.94331160, //
        -8.52146469, -1.91895665, -0.00849823, -2.28400856, //
        8.78693124, 0.72233959, 5.43860549, 2.46878679, //
        -5.19809722, 4.27454044, 2.17494402, 2.31159428, //
        -1.49848902, -1.60214850, -3.67494808, -4.37635054, //
        9.94588009, 2.82009079, 3.29063978, -5.47339001, //
        -8.04248514, -1.78002261, -4.55379372, -6.79963991, //
        -2.26939136, 0.11455796, 5.00041897, -2.74484344, //
        0.76391551, -3.70124211, 5.39301562, -2.89631614, //
        9.06390822, -2.17762788, 6.50003030, -7.92357588, //
        -0.33232025, -2.01548352, 9.27993685, 7.30439095, //
        1.72416926, -5.02483403, 1.82577134, 0.95410683, //
        0.32783744, -0.27648656, -5.92728829, 1.79158288, //
        -3.65052011, -5.04204193, 0.88516812, -7.06497156, //
        4.16972485, -2.28836509, 8.80020169, 0.04928755, //
        8.18829068, 1.04146359, -5.83411027, -8.83970354, //
        4.66074548, 4.66227662, -0.42915375, 9.87323421, //
        0.76593076, -3.78570959, 1.86236791, -7.54285984, //
        -2.01814759, -2.62291039, -5.15193422, -6.53818884, //
        4.89966237, 1.65129275, -0.83825289, -7.39312487, //
        -8.21511301, 1.12863599, 1.76784625, 6.20224983, //
        7.25089877, -8.77756084, -2.42079164, 2.29630940, //
        -4.27886282, -3.46773444, -2.96094408, -1.93377710, //
        -3.35297325, 9.40643801, 6.62358996, 1.32668823, //
        2.36915326, -4.70920195, 2.17679930, -5.96695375, //
        -4.17011902, -3.36949461, 4.15397066, 6.99181074, //
        4.99916878, -9.60554435, -2.99069840, -6.34611521, //
        -6.57231926, 1.66498525, -5.66126426, 8.38792150, //
        1.30149476, 8.10139226, 4.64561172, -5.07503152, //
        -9.35146997, 6.97495115, -0.50688111, 3.17489178, //
        4.60968486, -7.72969465, 7.81436243, 2.45965559, //
        3.92434723, -8.82137354, -2.70842582, -8.92449842,
      ],
      [
      [
        8.39072400, 0.00000000, -8.30917176, 7.57187599, //
        11.99009220, -10.01319104, -8.82210033, 1.55412089, //
        -3.17290736, 1.47549972, -4.62723942, 3.15435588, //
        18.39575189, 0.36515281, -13.00518241, -2.46869594, //
        6.71079037, 0.00000000, -13.00518241, 2.46869594, //
        18.39575189, -0.36515281, -4.62723942, -3.15435588, //
        -3.17290736, -1.47549972, -8.82210033, -1.55412089, //
        11.99009220, 10.01319104, -8.30917176, -7.57187599,
      ],
      [
        2.31329575, 0.00000000, 2.23518373, -4.56192847, //
        -2.92448193, 10.28798803, -0.61107800, -11.36292979, //
        -1.16964605, -1.53213370, 0.98597715, 9.00219166, //
        -1.17073831, 2.35603257, 3.31838202, -9.42456792, //
        -3.64049297, 0.00000000, 3.31838202, 9.42456792, //
        -1.17073831, -2.35603257, 0.98597715, -9.00219166, //
        -1.16964605, 1.53213370, -0.61107800, 11.36292979, //
        -2.92448193, -10.28798803, 2.23518373, 4.56192847,
      ],
      [
        -14.30271468, 0.00000000, 14.46922739, -12.74067974, //
        -15.46325379, 9.80878301, 10.44672066, 7.57847943, //
        -2.41516985, -11.13549437, 5.39585835, 2.89869086, //
        -9.86336568, -4.62296764, 1.50663897, 7.68676873, //
        6.14940258, 0.00000000, 1.50663897, -7.68676873, //
        -9.86336568, 4.62296764, 5.39585835, -2.89869086, //
        -2.41516985, 11.13549437, 10.44672066, -7.57847943, //
        -15.46325379, -9.80878301, 14.46922739, 12.74067974,
      ],
      [
        0.36638512, 0.00000000, -2.07541534, 4.84571586, //
        -2.47781283, 4.61266955, 9.03218213, -4.62136465, //
        -5.46153784, -2.96451516, 2.24125580, 3.36169999, //
        0.23255128, 1.58768196, -12.22029786, -4.71044730, //
        21.09176421, 0.00000000, -12.22029786, 4.71044730, //
        0.23255128, -1.58768196, 2.24125580, -3.36169999, //
        -5.46153784, 2.96451516, 9.03218213, 4.62136465, //
        -2.47781283, -4.61266955, -2.07541534, -4.84571586,
      ],
      [
        9.83184974, 0.00000000, -0.90626407, 3.53400183, //
        -13.27604986, -9.92081562, 16.26673134, 8.06949122, //
        -8.53773141, -0.35618069, 1.17477451, -1.12857345, //
        1.41595507, -6.13303803, -15.22048476, 11.97588307, //
        28.33428861, 0.00000000, -15.22048476, -11.97588307, //
        1.41595507, 6.13303803, 1.17477451, 1.12857345, //
        -8.53773141, 0.35618069, 16.26673134, -8.06949122, //
        -13.27604986, 9.92081562, -0.90626407, -3.53400183,
      ],
      [
        -1.68857311, 0.00000000, 3.75284805, -6.71285274, //
        1.83267366, -0.23306953, -7.83984999, -4.71452696, //
        1.23578234, 9.39667672, 1.01472256, 1.59796020, //
        -0.56610948, -9.43293306, 1.77525769, 8.45331719, //
        -0.72207656, 0.00000000, 1.77525769, -8.45331719, //
        -0.56610948, 9.43293306, 1.01472256, -1.59796020, //
        1.23578234, -9.39667672, -7.83984999, 4.71452696, //
        1.83267366, 0.23306953, 3.75284805, 6.71285274,
      ],
      [
        -0.92749621, 0.00000000, -0.13238754, 14.45368739, //
        -1.00673979, -11.54922101, 1.24274505, 3.03889399, //
        -1.23092277, -0.65054720, 2.71862868, 3.49712850, //
        7.62920467, -1.40697560, -20.32564860, -4.46822425, //
        23.13773684, 0.00000000, -20.32564860, 4.46822425, //
        7.62920467, 1.40697560, 2.71862868, -3.49712850, //
        -1.23092277, 0.65054720, 1.24274505, -3.03889399, //
        -1.00673979, 11.54922101, -0.13238754, -14.45368739,
      ],
      [
        6.33354239, 0.00000000, 1.90698529, 6.99290605, //
        -7.42435179, -19.18294886, -1.63890282, 17.31227582, //
        13.45904772, -7.54641565, -17.67148069, 3.73474262, //
        7.07054901, -6.52196763, -1.03588674, 10.44528282, //
        4.33453764, 0.00000000, -1.03588674, -10.44528282, //
        7.07054901, 6.52196763, -17.67148069, -3.73474262, //
        13.45904772, 7.54641565, -1.63890282, -17.31227582, //
        -7.42435179, 19.18294886, 1.90698529, -6.99290605,
      ],
      [
        -14.56410708, 0.00000000, 16.61022205, -4.37089546, //
        -8.96657016, 0.16966593, -4.99210935, 0.84200769, //
        2.40634634, -2.92312605, 6.05378289, 11.17917177, //
        0.74280059, -10.99681366, -9.68750796, 0.88708640, //
        10.23017827, 0.00000000, -9.68750796, -0.88708640, //
        0.74280059, 10.99681366, 6.05378289, -11.17917177, //
        2.40634634, 2.92312605, -4.99210935, -0.84200769, //
        -8.96657016, -0.16966593, 16.61022205, 4.37089546,
      ],
      [
        -8.75571395, 0.00000000, 9.55022129, 7.79965240, //
        -18.53900470, -8.12455411, 19.30494987, 8.86117215, //
        -2.52504579, -6.83979008, -0.89809035, 4.45489568, //
        -8.13376575, -5.45169993, 4.54433136, 4.19651338, //
        2.14852211, 0.00000000, 4.54433136, -4.19651338, //
        -8.13376575, 5.45169993, -0.89809035, -4.45489568, //
        -2.52504579, 6.83979008, 19.30494987, -8.86117215, //
        -18.53900470, 8.12455411, 9.55022129, -7.79965240,
      ],
      [
        -9.98641335, 0.00000000, 12.94802315, -2.72393070, //
        -4.86092168, -0.50034415, -9.43201971, -1.79080068, //
        2.44542899, 11.46091498, 10.84056431, -12.06382842, //
        -9.29527708, -0.55022027, 2.57187670, 7.65438478, //
        -0.44893602, 0.00000000, 2.57187670, -7.65438478, //
        -9.29527708, 0.55022027, 10.84056431, 12.06382842, //
        2.44542899, -11.46091498, -9.43201971, 1.79080068, //
        -4.86092168, 0.50034415, 12.94802315, 2.72393070,
      ],
      [
        5.80095153, 0.00000000, -7.27664079, -13.73248286, //
        1.65388987, 16.47061632, 8.94298906, -4.11017539, //
        -8.26261526, -4.73922943, -2.40919459, 1.92895340, //
        9.61758073, 6.41481307, -8.63022335, -9.33730012, //
        6.92747714, 0.00000000, -8.63022335, 9.33730012, //
        9.61758073, -6.41481307, -2.40919459, -1.92895340, //
        -8.26261526, 4.73922943, 8.94298906, 4.11017539, //
        1.65388987, -16.47061632, -7.27664079, 13.73248286,
      ],
      [
        -7.79385059, 0.00000000, -2.85906313, -9.27571984, //
        13.64879440, 18.91668957, -7.27741645, -19.45097189, //
        -1.25881625, 12.49268962, -0.63336103, -10.04520418, //
        5.38767539, 8.12571674, -9.00834684, 0.00073942, //
        11.79491842, 0.00000000, -9.00834684, -0.00073942, //
        5.38767539, -8.12571674, -0.63336103, 10.04520418, //
        -1.25881625, -12.49268962, -7.27741645, 19.45097189, //
        13.64879440, -18.91668957, -2.85906313, 9.27571984,
      ],
      [
        4.88981557, 0.00000000, -15.11659786, 5.95459606, //
        20.73533147, -1.92245771, -8.69319775, 5.77877729, //
        -3.42010669, -6.01420840, 4.53504595, -6.26145711, //
        -4.43976222, 14.34157473, 14.12565220, -7.68085207, //
        -20.34254577, 0.00000000, 14.12565220, 7.68085207, //
        -4.43976222, -14.34157473, 4.53504595, 6.26145711, //
        -3.42010669, 6.01420840, -8.69319775, -5.77877729, //
        20.73533147, 1.92245771, -15.11659786, -5.95459606,
      ],
      [
        6.68010633, 0.00000000, -7.78810335, 3.04479263, //
        3.50447573, 2.65815490, 9.46407168, -10.99268835, //
        -5.30309630, 5.61472312, -11.86402609, -5.63637516, //
        13.23146883, 17.06790153, -8.04921632, -17.68013818, //
        6.92874532, 0.00000000, -8.04921632, 17.68013818, //
        13.23146883, -17.06790153, -11.86402609, 5.63637516, //
        -5.30309630, -5.61472312, 9.46407168, 10.99268835, //
        3.50447573, -2.65815490, -7.78810335, -3.04479263,
      ],
      ],
    );
  });
  test('STFT 47 51 16 5', () {
    testStft(
      16,
      5,
      [
        -4.90935487, 0.64553488, 1.73077666, -1.67910545, //
        5.39389592, 8.80799405, 5.81819628, 7.82064498, //
        -7.78362071, -3.81874108, -1.04972599, 5.50441919, //
        -7.70799185, -8.96018865, 9.25268368, 8.32622733, //
        5.74829237, -3.30045354, 9.45528101, 2.11552700, //
        7.69805240, -0.50790970, 1.19558164, 7.33897693, //
        -4.06156991, -0.89991605, 8.72734695, 4.94794286, //
        9.44172842, -6.58729218, -6.89911067, -7.04569413, //
        1.13037873, 5.96533018, 0.61026774, -0.55121873, //
        4.19221259, 2.05121926, 3.62820273, -2.52555844, //
        -6.08971704, -2.42248343, 0.08356137, -4.13886333, //
        -5.31188661, 3.21462175, 3.56616950,
      ],
      [
      [
        9.67130965, 0.00000000, -3.39069791, -18.26028599, //
        -10.32975750, 15.93947982, 19.56727003, -7.20904918, //
        -12.54437747, 8.49748182, 1.18835658, -10.09770606, //
        -5.69901332, 3.61239938, 13.42937257, 1.41866302, //
        -14.11361559, 0.00000000, 13.42937257, -1.41866302, //
        -5.69901332, -3.61239938, 1.18835658, 10.09770606, //
        -12.54437747, -8.49748182, 19.56727003, 7.20904918, //
        -10.32975750, -15.93947982, -3.39069791, 18.26028599,
      ],
      [
        2.75639978, 0.00000000, 0.10529144, 14.62748917, //
        -5.80077464, -13.74861877, 18.87483610, 10.47554520, //
        -24.72023952, -16.53594415, 12.76306951, 12.32306670, //
        -5.42533553, -8.81215051, 3.70595433, 12.60030885, //
        -1.76200316, 0.00000000, 3.70595433, -12.60030885, //
        -5.42533553, 8.81215051, 12.76306951, -12.32306670, //
        -24.72023952, 16.53594415, 18.87483610, -10.47554520, //
        -5.80077464, 13.74861877, 0.10529144, -14.62748917,
      ],
      [
        27.36682253, 0.00000000, -19.67137087, -3.66963931, //
        0.15516444, 4.35733239, 7.28939595, 11.29210939, //
        5.35278154, -16.25080661, -8.42363109, -0.46866878, //
        7.50279793, 3.30645499, -16.60227688, 3.35703429, //
        21.42745542, 0.00000000, -16.60227688, -3.35703429, //
        7.50279793, -3.30645499, -8.42363109, 0.46866878, //
        5.35278154, 16.25080661, 7.28939595, -11.29210939, //
        0.15516444, -4.35733239, -19.67137087, 3.66963931,
      ],
      [
        21.35081259, 0.00000000, -6.71900906, -3.83611912, //
        -8.10989281, 3.20393403, -1.09919791, -4.20760636, //
        12.10169778, 5.35875200, -13.84771639, -3.18999437, //
        16.87186820, 2.25035952, -7.36923584, -4.98307643, //
        -5.00784053, 0.00000000, -7.36923584, 4.98307643, //
        16.87186820, -2.25035952, -13.84771639, 3.18999437, //
        12.10169778, -5.35875200, -1.09919791, 4.20760636, //
        -8.10989281, -3.20393403, -6.71900906, 3.83611912,
      ],
      [
        8.29990825, 0.00000000, -7.04472885, -15.27494915, //
        11.16086694, 21.76510709, -14.64784582, -20.17784647, //
        4.54224530, 9.20663171, -0.50017948, 3.81311308, //
        11.22131257, -4.02865692, -15.16151069, -1.81837372, //
        12.55977182, 0.00000000, -15.16151069, 1.81837372, //
        11.22131257, 4.02865692, -0.50017948, -3.81311308, //
        4.54224530, -9.20663171, -14.64784582, 20.17784647, //
        11.16086694, -21.76510709, -7.04472885, 15.27494915,
      ],
      [
        -0.05558773, 0.00000000, 0.77791314, 12.00384625, //
        9.56771454, -13.93181292, -17.90488115, -3.50761143, //
        9.04782059, 10.34012462, -4.49593268, -1.93035947, //
        8.09108309, -0.15739174, -1.97770645, -3.80532052, //
        -6.15643442, 0.00000000, -1.97770645, 3.80532052, //
        8.09108309, 0.15739174, -4.49593268, 1.93035947, //
        9.04782059, -10.34012462, -17.90488115, 3.50761143, //
        9.56771454, 13.93181292, 0.77791314, -12.00384625,
      ],
      [
        2.20129499, 0.00000000, -1.91880944, -11.43837288, //
        3.09174613, 9.91999349, -7.01491609, -8.19626722, //
        4.77246942, 6.43900802, -1.19851379, 3.59827226, //
        3.35357683, -5.96512143, -4.22200173, 1.58880380, //
        4.07160235, 0.00000000, -4.22200173, -1.58880380, //
        3.35357683, 5.96512143, -1.19851379, -3.59827226, //
        4.77246942, -6.43900802, -7.01491609, 8.19626722, //
        3.09174613, -9.91999349, -1.91880944, 11.43837288,
      ],
      [
        -10.81435159, 0.00000000, 10.18198655, 7.35046011, //
        -4.95911385, -7.12231895, 2.32733015, -5.08503934, //
        -6.04756918, 12.49634587, 5.69090671, -8.32396990, //
        -0.43861754, 2.76061304, -1.82565826, -1.46757281, //
        0.95582244, 0.00000000, -1.82565826, 1.46757281, //
        -0.43861754, -2.76061304, 5.69090671, 8.32396990, //
        -6.04756918, -12.49634587, 2.32733015, 5.08503934, //
        -4.95911385, 7.12231895, 10.18198655, -7.35046011,
      ],
      ],
    );
  });
}

